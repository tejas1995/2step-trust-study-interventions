(()=>{"use strict";var t={d:(i,n)=>{for(var e in n)t.o(n,e)&&!t.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:n[e]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)};t.d({},{o:()=>o});let i="https://tejassrinivasan.pythonanywhere.com/",n=null;function e(t,i,e,o,a){n&&(clearInterval(n),n=null),e.forEach((t=>t.setAttribute("disabled","true")));let l=document.createElement("div");l.id=`timer_${i.id}`,l.style.fontWeight="bold",l.style.marginTop="10px",i.appendChild(l);let r=t;l.textContent=a+` You can make your selection in ${r} second(s).`,n=setInterval((()=>{r--,r>=0?l.textContent=a+` You can make your selection in ${r} second(s).`:(null!==n&&(clearInterval(n),n=null),n=null,i.removeChild(l),e.forEach((t=>t.removeAttribute("disabled"))),o&&o())}),1e3)}var o=!1,a=[];let l,r,c,_,s,d=-1,u=null,p=-1,f=-1,b=-1,v=-1,g=0,h=5,m=-1,A=1,x=0,y=0;var w={},I={};function T(t,i){if(!t)throw i||"Assertion failed"}function k(t){x+=t,L&&5==x&&(x+=t),0==x?$("#button_instructions_prev").attr("disabled","true"):$("#button_instructions_prev").removeAttr("disabled"),x>=6?($("#instructions_and_decorations").show(),$("#button_instructions_next").val("Start study")):($("#instructions_and_decorations").hide(),$("#button_instructions_next").val("Next")),7==x&&($("#main_box_instructions").hide(),$("#main_box_experiment").show(),N()),$("#main_box_instructions").children(":not(input)").each(((t,i)=>{$(i).hide()})),$(`#instructions_${x}`).show()}function E(t){_=Date.now(),p=t,T(1==t||2==t,"Invalid option!"),1==t?($("#button_initial_decision_option1").attr("activedecision","true"),$("#button_initial_decision_option2").removeAttr("activedecision")):($("#button_initial_decision_option1").removeAttr("activedecision"),$("#button_initial_decision_option2").attr("activedecision","true")),$("#initial_user_confidence_div").show(),$("#button_initial_decision_option1").attr("disabled","true"),$("#button_initial_decision_option2").attr("disabled","true"),$("#button_initial_confidence_option1").removeAttr("disabled"),$("#button_initial_confidence_option2").removeAttr("disabled"),$("#button_initial_confidence_option3").removeAttr("disabled")}function O(t){r=Date.now(),b=t,T(1==t||2==t||3==t,"Invalid option!"),1==t?($("#button_initial_confidence_option1").attr("activedecision","true"),$("#button_initial_confidence_option2").removeAttr("activedecision"),$("#button_initial_confidence_option3").removeAttr("activedecision")):2==t?($("#button_initial_confidence_option1").removeAttr("activedecision"),$("#button_initial_confidence_option2").attr("activedecision","true"),$("#button_initial_confidence_option3").removeAttr("activedecision")):($("#button_initial_confidence_option1").removeAttr("activedecision"),$("#button_initial_confidence_option2").removeAttr("activedecision"),$("#button_initial_confidence_option3").attr("activedecision","true")),$("#button_initial_confidence_option1").attr("disabled","true"),$("#button_initial_confidence_option2").attr("disabled","true"),$("#button_initial_confidence_option3").attr("disabled","true"),$("#button_final_decision_option1").removeAttr("disabled"),$("#button_final_decision_option2").removeAttr("disabled"),async function(){console.log("Getting AI assistance...");let t=u.ai_confidence,i=0;if(J&&(i=(h-5)/2.5,console.log("Using user reported trust value: ",h)),w={intervention_applied:!1,trust_level_at_start_of_interaction:i},"none"==Y||p==u.ai_prediction)console.log("Not applying any intervention."),t=u.ai_confidence;else if("confidence_manip"==Y)if("none"==j||"mitigate_undertrust"==j&&i<M||"mitigate_overtrust"==j&&i>M){if(console.log("Applying AI confidence manipulation intervention."),"fixed"==U){let i=Number(u.ai_confidence.replace("%",""))/100,n=Math.min(1,i+G);n=Math.max(.5,n),t=String((100*n).toFixed(0))+"%";let e=(n-i).toFixed(2);console.log("Actual AI confidence: ",u.ai_confidence,", Confidence shown to user: ",t),w.conf_actual=u.ai_confidence,w.conf_displayed=t,w.conf_change=e,w.intervention_applied=!0}}else console.log("Conditions for applying 'confidence manipulation' intervention not satisfied.");else if("ai_explanation"==Y)if("none"==j||"mitigate_undertrust"==j&&i<M||"mitigate_overtrust"==j&&i>M){if(console.log("Applying AI explanation intervention."),"fixed"==U){console.log("Showing explanation");let t=u.ai_explanation?u.ai_explanation:"No explanation provided";$("#ai_explanation_span").html(t),$("#ai_explanation_div").show(),w.explanation_shown=t,w.intervention_applied=!0,e(15,document.getElementById("ai_explanation_div"),[document.getElementById("button_final_decision_option1"),document.getElementById("button_final_decision_option2")],null,"Please read the explanation.")}}else console.log("Conditions for applying 'AI explanation' intervention not satisfied.");else if("ai_contrastive_explanation"==Y)if("none"==j||"mitigate_undertrust"==j&&i<M||"mitigate_overtrust"==j&&i>M){if(console.log("Applying AI explanation intervention."),"fixed"==U){console.log("Showing explanation");let t=u.ai_contrastive_explanation?u.ai_contrastive_explanation:"No explanation provided";$("#ai_contrastive_explanation_span").html(t),$("#ai_contrastive_explanation_div").show(),w.explanation_shown=t,w.intervention_applied=!0,e(10,document.getElementById("ai_contrastive_explanation_div"),[document.getElementById("button_final_decision_option1"),document.getElementById("button_final_decision_option2")],null,"Please read the explanation.")}}else console.log("Conditions for applying 'AI explanation' intervention not satisfied.");console.log("AI Assistance Intervention Details: ",w),$("#ai_prediction_span").html("Option "+u.ai_prediction),$("#ai_confidence_span").html(t),$("#ai_assistance_div").show(),$("#final_user_decision_div").show()}()}function S(t){s=Date.now(),f=t,T(1==t||2==t,"Invalid option!"),1==t?($("#button_final_decision_option1").attr("activedecision","true"),$("#button_final_decision_option2").removeAttr("activedecision")):($("#button_final_decision_option1").removeAttr("activedecision"),$("#button_final_decision_option2").attr("activedecision","true")),$("#final_user_confidence_div").show(),$("#button_final_decision_option1").attr("disabled","true"),$("#button_final_decision_option2").attr("disabled","true"),$("#button_final_confidence_option1").removeAttr("disabled"),$("#button_final_confidence_option2").removeAttr("disabled"),$("#button_final_confidence_option3").removeAttr("disabled")}function C(t){c=Date.now(),v=t,T(1==t||2==t||3==t,"Invalid option!"),1==t?($("#button_final_confidence_option1").attr("activedecision","true"),$("#button_final_confidence_option2").removeAttr("activedecision"),$("#button_final_confidence_option3").removeAttr("activedecision")):2==t?($("#button_final_confidence_option1").removeAttr("activedecision"),$("#button_final_confidence_option2").attr("activedecision","true"),$("#button_final_confidence_option3").removeAttr("activedecision")):($("#button_final_confidence_option1").removeAttr("activedecision"),$("#button_final_confidence_option2").removeAttr("activedecision"),$("#button_final_confidence_option3").attr("activedecision","true")),$("#button_final_confidence_option1").attr("disabled","true"),$("#button_final_confidence_option2").attr("disabled","true"),$("#button_final_confidence_option3").attr("disabled","true"),async function(){let t=u.correct_option,i=t==f,n=u.ai_is_correct,e="Correct answer: <b>Option "+t+"</b>.<br>";e+=i?"You picked Option "+f+", which was <span class='color_correct'><b>correct</b></span>.<br>":"You picked Option "+f+", which was <span class='color_incorrect'><b>incorrect</b></span>.<br>",e+=n?"The AI picked Option "+u.ai_prediction+", which was <span class='color_correct'><b>correct<b></span>.<br>":"The AI picked Option "+u.ai_prediction+", which was <span class='color_incorrect'><b>incorrect</b></span>.<br>",i?(e+="<span class='color_correct'><b>You receive a reward of $0.10.</b></span>",g+=.1):e+="<span class='color_incorrect'><b>You do not receive any reward.</b></span>",e+="<br>",$("#balance").text(`Balance: $${g.toFixed(2)} + $1.0`),$("#result_span").html(e),$("#result_span").show(),L?$("#button_next").show():$("#user_trust_report_div").show()}()}function N(){if($("#button_initial_decision_option1").removeAttr("activedecision"),$("#button_initial_decision_option2").removeAttr("activedecision"),$("#button_initial_decision_option1").removeAttr("disabled"),$("#button_initial_decision_option2").removeAttr("disabled"),$("#button_initial_confidence_option1").removeAttr("activedecision"),$("#button_initial_confidence_option2").removeAttr("activedecision"),$("#button_initial_confidence_option3").removeAttr("activedecision"),$("#button_initial_confidence_option1").removeAttr("disabled"),$("#button_initial_confidence_option2").removeAttr("disabled"),$("#button_initial_confidence_option3").removeAttr("disabled"),$("#button_final_decision_option1").removeAttr("activedecision"),$("#button_final_decision_option2").removeAttr("activedecision"),$("#button_final_decision_option1").removeAttr("disabled"),$("#button_final_decision_option2").removeAttr("disabled"),$("#button_final_confidence_option1").removeAttr("activedecision"),$("#button_final_confidence_option2").removeAttr("activedecision"),$("#button_final_confidence_option3").removeAttr("activedecision"),$("#button_final_confidence_option1").removeAttr("disabled"),$("#button_final_confidence_option2").removeAttr("disabled"),$("#button_final_confidence_option3").removeAttr("disabled"),$("#ai_assistance_div").hide(),$("#ai_explanation_div").hide(),$("#ai_contrastive_explanation_div").hide(),$("#initial_user_confidence_div").hide(),$("#final_user_decision_div").hide(),$("#final_user_confidence_div").hide(),$("#range_val").removeAttr("disabled"),$("#user_trust_report_div").hide(),$("#button_place_bet").hide(),$("#button_next").hide(),$("#result_span").hide(),-1==d?$("#range_text").text("-"):$("#range_text").text(`Before this interaction, your trust in the AI: ${10*h} / 100.`),$("#range_val").val(h),m=h,d+=1,d>=a.length)return $("#main_box_experiment").hide(),void(o?$("#main_box_end_mock").show():$("#main_box_end").show());if(u=a[d],$("#question_span").html(u.question),$("#option1_span").html(u.option1),$("#option2_span").html(u.option2),u.hasOwnProperty("reward_ratio")){let[t,i]=u.reward_ratio;t=Number(t),i=Number(i),A=t/i}else A=1;l=Date.now(),$("#progress").text(`Progress: ${d+1} / ${a.length}`),e(10,document.getElementById("initial_user_decision_div"),[document.getElementById("button_initial_decision_option1"),document.getElementById("button_initial_decision_option2")],null,"Please read the question and options closely.")}$("#button_instructions_next").on("click",(()=>k(1))),$("#button_instructions_prev").on("click",(()=>k(-1))),$("#button_next").on("click",(()=>{if(-1!=d){let t={question_i:d,user_balance_post_interaction:g,user_trust_val_before:m,user_trust_val_after:h,initial_user_decision:p,final_user_decision:f,initial_user_confidence:b,final_user_confidence:v};t.times={initial_decision:_-l,initial_confidence:r-_,final_decision:s-r,final_confidence:c-s,trust_decision:Date.now()-c},t.question=u,t.count_exited_page=y,t.intervention_details=w,t.trust_effect_prediction_data=I,async function(t){if(o)console.log("logged (mock)",t);else{t.url_data=globalThis.url_data,console.log("Data"),"study_id"in t.url_data||(t.url_data.study_id="trialrun_studies"),t.url_data.queue_id=globalThis.uid,console.log("logged",t),console.log("Logging to",i+"log");try{return await $.ajax(i+"log",{data:JSON.stringify({project:"2step-trust-study-interventions/"+t.url_data.study_id,uid:globalThis.uid.replace("/","_")+"_"+t.url_data.prolific_id,payload:JSON.stringify(t)}),type:"POST",contentType:"application/json"})}catch(t){console.log(t)}}}(t),y=0}N()})),$("#range_val").on("input change",(function(){h=$(this).val(),$("#range_text").text(`After this interaction, your current trust in the AI: ${10*h} / 100.`),$("#button_next").show()})),$("#button_initial_decision_option1").on("click",(()=>E(1))),$("#button_initial_decision_option2").on("click",(()=>E(2))),$("#button_initial_confidence_option1").on("click",(()=>O(1))),$("#button_initial_confidence_option2").on("click",(()=>O(2))),$("#button_initial_confidence_option3").on("click",(()=>O(3))),$("#button_final_decision_option1").on("click",(()=>S(1))),$("#button_final_decision_option2").on("click",(()=>S(2))),$("#button_final_confidence_option1").on("click",(()=>C(1))),$("#button_final_confidence_option2").on("click",(()=>C(2))),$("#button_final_confidence_option3").on("click",(()=>C(3)));const D=new URLSearchParams(window.location.search),B=D.get("start"),P=D.get("uid");if(globalThis.url_data=function(t){const i={};for(const[n,e]of t)i[n]=e;return i}(D.entries()),null!=P){if(globalThis.uid=P,"prolific_random"==globalThis.uid){let t=`${Math.floor(10*Math.random())}`.padStart(3,"0");globalThis.uid=`${D.get("prolific_queue_name")}/${t}`}}else{let t=null;for(;null==t;)t=prompt("Enter your user id. Please get in touch if you were not assigned an id but wish to participate in this experiment.");globalThis.uid=t}let q=null;globalThis.uid.includes("343")||globalThis.uid.includes("434")?q=[7,8,9,17,18,19,27,28,29]:globalThis.uid.includes("735")&&(q=[10,11,12,13,14,25,26,27,28,29]);let j=D.get("intervention_goal");if(null==j&&(j="none"),!["none","mitigate_undertrust","mitigate_overtrust"].includes(j))throw new Error("Invalid AI Assistance Intervention Goal: "+j);let Y=D.get("intervention_type");if(null==Y&&(Y="none"),!["none","dummy","confidence_manip","ai_explanation","ai_contrastive_explanation"].includes(Y))throw new Error("Invalid AI Assistance Intervention: "+Y);let U=D.get("intervention_strategy");if(null==U&&(U="dummy"),!["dummy","fixed","adaptive"].includes(U))throw new Error("Invalid AI Assistance Intervention Strategy: "+U);let F=Number(D.get("intervention_threshold"));null==F&&(F=-1);let M=Number(D.get("intervention_trust_threshold"));null==M&&(M=0);let G=Number(D.get("intervention_fixedconfchange"));null==G&&(G=0);let J="true"==D.get("use_user_reported_trust_level");null==J&&(J=!1);let L="true"==D.get("skip_trust_reporting");null==L&&(L=!1),console.log("AIInterventionGoal: ",j),console.log("AIInterventionType: ",Y),console.log("AIInterventionStrategy: ",U),console.log("InterventionALDiffThreshold: ",F),console.log("InterventionTrustThreshold: ",M),console.log("InterventionFixedConfChange: ",G),console.log("useUserReportedTrustVal: ",J),console.log("skip_trust_reporting: ",L),"mitigate_undertrust"==j?(T(M<=0,"Trust threshold for mitigating undertrust cannot be positive."),T(G>=0,"Confidence change for mitigating undertrust cannot be negative.")):"mitigate_overtrust"==j&&(T(M>=0,"Trust threshold for mitigating overtrust cannot be negative."),T(G<=0,"Confidence change for mitigating overtrust cannot be positive.")),globalThis.url_data.intervention_goal=j,globalThis.url_data.intervention_type=Y,globalThis.url_data.intervention_strategy=U,globalThis.url_data.intervention_threshold=F,globalThis.url_data.intervention_fixedconfchange=G,globalThis.url_data.use_user_reported_trust_level=J,globalThis.uid.startsWith("demo_paper")&&(o=!0),console.log("Running with UID",globalThis.uid),async function(){return await $.getJSON(`baked_queues/${globalThis.uid}.json?t=${Date.now()}`)}().catch((t=>{console.log("Invalid user id."),console.log(globalThis.uid),window.location.reload()})).then((t=>{a=t,null!=B&&(d=parseInt(B)-1,console.log("Starting from",d)),k(0),$("#main_box_instructions").show(),$("#instructions_and_decorations").hide()})),console.log("Starting session with UID:",globalThis.uid);let R=!1;document.onvisibilitychange=()=>{R||(y+=1,R=!0,globalThis.uid.startsWith("demo")||alert("Please don't leave the page. If you do so again, we may restrict paying you."),R=!1)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSwwQkFBMEJHLE9BQzVCSCxFQUFFLGlDQUFpQ0ssTUFBTSxJQUc3Q2EsUUFBUUMsSUFBSSw2QkFBOEJtQyxXQUFXRSxLQUVyRCxJQUFJeUMsR0FBZSxFQUNuQnZJLFNBQVN3SSxtQkFBcUIsS0FDckJELElBQ0R6RyxHQUFxQixFQUNyQnlHLEdBQWUsRUFDVDNDLFdBQVdFLElBQUtnQyxXQUFXLFNBQzdCVyxNQUFNLGdGQUVWRixHQUFlLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly8vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly8vLi9zcmMvY29ubmVjdG9yLnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7IERFVk1PREUgfSBmcm9tICcuL2dsb2JhbHMnXG5pbXBvcnQgeyBNT0NLTU9ERSB9IGZyb20gJy4vbWFpbidcblxubGV0IFNFUlZFUl9MT0dfUk9PVCA9IERFVk1PREUgPyBcImh0dHA6Ly8xMjcuMC4wLjE6NTAwMC9cIiA6IFwiaHR0cHM6Ly90ZWphc3NyaW5pdmFzYW4ucHl0aG9uYW55d2hlcmUuY29tL1wiXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2RhdGEoKTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBpbmNsdWRlIHRpbWVzdGFtcCBzbyB0aGF0IHRoaW5ncyBkb24ndCBnZXQgY2FjaGVkXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0ICQuZ2V0SlNPTihcbiAgICAgICAgYGJha2VkX3F1ZXVlcy8ke2dsb2JhbFRoaXMudWlkfS5qc29uP3Q9JHtEYXRlLm5vdygpfWAsXG4gICAgKVxuICAgIHJldHVybiByZXN1bHRcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dfZGF0YShkYXRhKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoTU9DS01PREUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJsb2dnZWQgKG1vY2spXCIsIGRhdGEpXG4gICAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGRhdGFbXCJ1cmxfZGF0YVwiXSA9IGdsb2JhbFRoaXMudXJsX2RhdGFcbiAgICBjb25zb2xlLmxvZyhcIkRhdGFcIilcbiAgICBpZiAoIShcInN0dWR5X2lkXCIgaW4gZGF0YVsndXJsX2RhdGEnXSkpIHtcbiAgICAgICAgZGF0YVsndXJsX2RhdGEnXVtcInN0dWR5X2lkXCJdID0gXCJ0cmlhbHJ1bl9zdHVkaWVzXCJcbiAgICB9XG4gICAgZGF0YVtcInVybF9kYXRhXCJdW1wicXVldWVfaWRcIl0gPSBnbG9iYWxUaGlzLnVpZFxuICAgIGNvbnNvbGUubG9nKFwibG9nZ2VkXCIsIGRhdGEpXG4gICAgY29uc29sZS5sb2coXCJMb2dnaW5nIHRvXCIsIFNFUlZFUl9MT0dfUk9PVCArIFwibG9nXCIpXG5cbiAgICB0cnkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgJC5hamF4KFxuICAgICAgICAgICAgU0VSVkVSX0xPR19ST09UICsgXCJsb2dcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6IFwiMnN0ZXAtdHJ1c3Qtc3R1ZHktaW50ZXJ2ZW50aW9ucy9cIiArIGRhdGFbJ3VybF9kYXRhJ11bJ3N0dWR5X2lkJ10sXG4gICAgICAgICAgICAgICAgICAgIHVpZDogZ2xvYmFsVGhpcy51aWQucmVwbGFjZShcIi9cIiwgXCJfXCIpICsgXCJfXCIgKyBkYXRhWyd1cmxfZGF0YSddWydwcm9saWZpY19pZCddLFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgIH1cbn0iLCJpbXBvcnQgeyBFTkFCTEVfVElNRVIgfSBmcm9tICcuL2dsb2JhbHMnO1xuXG5mdW5jdGlvbiBwYXJhbXNUb09iamVjdChlbnRyaWVzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9XG4gIC8vIGVhY2ggJ2VudHJ5JyBpcyBhIFtrZXksIHZhbHVlXSB0dXBwbGVcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgZW50cmllcykge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubGV0IGFjdGl2ZVRpbWVyOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRJbnRlcnZhbD4gfCBudWxsID0gbnVsbDsgLy8gVGltZXIgaW50ZXJ2YWxcblxuZnVuY3Rpb24gc3RhcnRUaW1lcihkdXJhdGlvbiwgc3RlcERpdiwgYnV0dG9ucywgY2FsbGJhY2ssIG1lc3NhZ2UpIHtcbiAgaWYgKCFFTkFCTEVfVElNRVIpIHtcbiAgICAgIC8vIElmIHRoZSB0aW1lciBpcyBkaXNhYmxlZCwgZW5hYmxlIHRoZSBidXR0b25zIGltbWVkaWF0ZWx5XG4gICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSk7XG4gICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gICAgICByZXR1cm47XG4gIH1cblxuICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgdGltZXIgdG8gcHJldmVudCBtdWx0aXBsZSBpbnRlcnZhbHNcbiAgaWYgKGFjdGl2ZVRpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKGFjdGl2ZVRpbWVyKTtcbiAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgfVxuXG4gIC8vIERpc2FibGUgYnV0dG9uc1xuICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcInRydWVcIikpO1xuICBcbiAgLy8gU2hvdyB0aW1lciB2aXN1YWxseVxuICBsZXQgdGltZXJEaXNwbGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHRpbWVyRGlzcGxheS5pZCA9IGB0aW1lcl8ke3N0ZXBEaXYuaWR9YDtcbiAgdGltZXJEaXNwbGF5LnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG4gIHRpbWVyRGlzcGxheS5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7XG4gIHN0ZXBEaXYuYXBwZW5kQ2hpbGQodGltZXJEaXNwbGF5KTtcblxuICBsZXQgcmVtYWluaW5nVGltZSA9IGR1cmF0aW9uO1xuXG4gIC8vIEluaXRpYWwgZGlzcGxheVxuICB0aW1lckRpc3BsYXkudGV4dENvbnRlbnQgPSBtZXNzYWdlICsgYCBZb3UgY2FuIG1ha2UgeW91ciBzZWxlY3Rpb24gaW4gJHtyZW1haW5pbmdUaW1lfSBzZWNvbmQocykuYDtcblxuICBhY3RpdmVUaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHJlbWFpbmluZ1RpbWUtLTtcbiAgICAgIGlmIChyZW1haW5pbmdUaW1lID49IDApIHtcbiAgICAgICAgICB0aW1lckRpc3BsYXkudGV4dENvbnRlbnQgPSBtZXNzYWdlICsgYCBZb3UgY2FuIG1ha2UgeW91ciBzZWxlY3Rpb24gaW4gJHtyZW1haW5pbmdUaW1lfSBzZWNvbmQocykuYDtcbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICBpZiAoYWN0aXZlVGltZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhY3RpdmVUaW1lcik7IC8vIFN0b3AgdGhlIHRpbWVyXG4gICAgICAgICAgICAgIGFjdGl2ZVRpbWVyID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWN0aXZlVGltZXIgPSBudWxsO1xuXG4gICAgICAgICAgLy8gUmVtb3ZlIHRpbWVyIGRpc3BsYXlcbiAgICAgICAgICBzdGVwRGl2LnJlbW92ZUNoaWxkKHRpbWVyRGlzcGxheSk7XG5cbiAgICAgICAgICAvLyBFbmFibGUgYnV0dG9uc1xuICAgICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4gYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcblxuICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgfSwgMTAwMCk7XG59XG5cbmV4cG9ydCB7IHBhcmFtc1RvT2JqZWN0LCBzdGFydFRpbWVyIH07IiwiaW1wb3J0IHsgREVWTU9ERSB9IGZyb20gXCIuL2dsb2JhbHNcIlxuZXhwb3J0IHZhciBVSUQ6IHN0cmluZ1xuZXhwb3J0IHZhciBNT0NLTU9ERTogYm9vbGVhbiA9IGZhbHNlXG5pbXBvcnQgeyBsb2FkX2RhdGEsIGxvZ19kYXRhIH0gZnJvbSAnLi9jb25uZWN0b3InXG5pbXBvcnQgeyBwYXJhbXNUb09iamVjdCwgc3RhcnRUaW1lciB9IGZyb20gXCIuL3V0aWxzXCJcbi8vaW1wb3J0IHsgZ2V0X3VzZXJfdHJ1c3RfZWZmZWN0LCBnZXRfYWRqdXN0ZWRfYWlfY29uZmlkZW5jZX0gZnJvbSBcIi4vcnVuX3VzZXJfbW9kZWxzXCJcblxubGV0IFVTRVJfTU9ERUxTX1JPT1QgPSBcImh0dHBzOi8vdGVqYXNzcmluaXZhc2FuLnB5dGhvbmFueXdoZXJlLmNvbS9cIlxubGV0IHVzZXJfZGVjaXNpb25fbW9kZWwgPSBcInVzZXJfYWNjZXB0YW5jZV9tb2RlbC1sb2dpc3RpY3JlZ3Jlc3Npb24tMC45MzQ3dGVzdGYxXCJcbmxldCB0cnVzdF9lZmZlY3RfbW9kZWwgPSBcInRydXN0X2VmZmVjdF9tb2RlbC1zdm1fbGluZWFyLTAuNDY0NHRlc3RtYWUtMC45MDk1dGVzdHRlZGFcIlxuXG52YXIgZGF0YTogYW55W10gPSBbXVxubGV0IHF1ZXN0aW9uX2kgPSAtMVxubGV0IHF1ZXN0aW9uOiBhbnkgPSBudWxsXG5sZXQgaW5pdGlhbF91c2VyX2RlY2lzaW9uOiBudW1iZXIgPSAtMVxubGV0IGZpbmFsX3VzZXJfZGVjaXNpb246IG51bWJlciA9IC0xXG5sZXQgaW5pdGlhbF91c2VyX2NvbmZpZGVuY2U6IG51bWJlciA9IC0xXG5sZXQgZmluYWxfdXNlcl9jb25maWRlbmNlOiBudW1iZXIgPSAtMVxubGV0IGJhbGFuY2UgPSAwXG5cbmxldCB1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsOiBudW1iZXIgPSA1XG5sZXQgcHJldl91c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsOiBudW1iZXIgPSAtMVxuXG5sZXQgYmV0X3ZhbF9yYXRpbzogbnVtYmVyID0gMVxubGV0IHRpbWVfcXVlc3Rpb25fc3RhcnQ6IG51bWJlclxubGV0IHRpbWVfZmluYWxfZGVjaXNpb25fc3RhcnQ6IG51bWJlclxubGV0IHRpbWVfdHJ1c3RfZGVjaXNpb25fc3RhcnQ6IG51bWJlclxubGV0IHRpbWVfaW5pdGlhbF9jb25maWRlbmNlX3N0YXJ0OiBudW1iZXJcbmxldCB0aW1lX2ZpbmFsX2NvbmZpZGVuY2Vfc3RhcnQ6IG51bWJlclxubGV0IGluc3RydWN0aW9uX2k6IG51bWJlciA9IDBcbmxldCBjb3VudF9leGl0ZWRfcGFnZTogbnVtYmVyID0gMFxuXG5sZXQgaW50ZXJ2ZW50aW9uX2NvbmRpdGlvbl9zYXRpc2ZpZWQ6IGJvb2xlYW4gPSBmYWxzZVxubGV0IGludGVydmVudGlvbl9hcHBsaWVkOiBib29sZWFuID0gZmFsc2VcblxubGV0IHVzZXJfY3VycmVudF9lc3RpbWF0ZWRfdHJ1c3RfbGV2ZWw6IG51bWJlciA9IDBcblxudmFyIGFsbF91c2VyX2ludGVyYWN0aW9ucyA9IFtdXG52YXIgaW50ZXJ2ZW50aW9uX2RldGFpbHMgPSB7fVxudmFyIHRydXN0X2VmZmVjdF9wcmVkaWN0aW9uX2RhdGEgPSB7fVxubGV0IGZpbmRuZXdjb25mX3Jlc3VsdDogYW55XG5cbmZ1bmN0aW9uIGFzc2VydChjb25kaXRpb24sIG1lc3NhZ2UpIHtcbiAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICB0aHJvdyBtZXNzYWdlIHx8IFwiQXNzZXJ0aW9uIGZhaWxlZFwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbmV4dF9pbnN0cnVjdGlvbnMoaW5jcmVtZW50OiBudW1iZXIpIHtcbiAgICBpbnN0cnVjdGlvbl9pICs9IGluY3JlbWVudFxuICAgIGlmIChza2lwX3RydXN0X3JlcG9ydGluZyAmJiBpbnN0cnVjdGlvbl9pID09IDUpIHtcbiAgICAgICAgaW5zdHJ1Y3Rpb25faSArPSBpbmNyZW1lbnRcbiAgICB9XG5cbiAgICBpZiAoaW5zdHJ1Y3Rpb25faSA9PSAwKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19wcmV2XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICB9XG4gICAgaWYgKGluc3RydWN0aW9uX2kgPj0gNikge1xuICAgICAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuc2hvdygpXG4gICAgICAgICQoXCIjYnV0dG9uX2luc3RydWN0aW9uc19uZXh0XCIpLnZhbChcIlN0YXJ0IHN0dWR5XCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNpbnN0cnVjdGlvbnNfYW5kX2RlY29yYXRpb25zXCIpLmhpZGUoKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfbmV4dFwiKS52YWwoXCJOZXh0XCIpXG4gICAgfVxuICAgIGlmIChpbnN0cnVjdGlvbl9pID09IDcpIHtcbiAgICAgICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuaGlkZSgpXG4gICAgICAgICQoXCIjbWFpbl9ib3hfZXhwZXJpbWVudFwiKS5zaG93KClcbiAgICAgICAgbmV4dF9xdWVzdGlvbigpXG4gICAgfVxuXG4gICAgJChcIiNtYWluX2JveF9pbnN0cnVjdGlvbnNcIikuY2hpbGRyZW4oXCI6bm90KGlucHV0KVwiKS5lYWNoKChfLCBlbCkgPT4ge1xuICAgICAgICAkKGVsKS5oaWRlKClcbiAgICB9KVxuICAgICQoYCNpbnN0cnVjdGlvbnNfJHtpbnN0cnVjdGlvbl9pfWApLnNob3coKVxufVxuJChcIiNidXR0b25faW5zdHJ1Y3Rpb25zX25leHRcIikub24oXCJjbGlja1wiLCAoKSA9PiBuZXh0X2luc3RydWN0aW9ucygrMSkpXG4kKFwiI2J1dHRvbl9pbnN0cnVjdGlvbnNfcHJldlwiKS5vbihcImNsaWNrXCIsICgpID0+IG5leHRfaW5zdHJ1Y3Rpb25zKC0xKSlcblxuJChcIiNidXR0b25fbmV4dFwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICBpZiAocXVlc3Rpb25faSAhPSAtMSkge1xuICAgICAgICBsZXQgbG9nZ2VkX2RhdGEgPSB7XG4gICAgICAgICAgICBcInF1ZXN0aW9uX2lcIjogcXVlc3Rpb25faSxcbiAgICAgICAgICAgIFwidXNlcl9iYWxhbmNlX3Bvc3RfaW50ZXJhY3Rpb25cIjogYmFsYW5jZSxcbiAgICAgICAgICAgIFwidXNlcl90cnVzdF92YWxfYmVmb3JlXCI6IHByZXZfdXNlcl9yZXBvcnRlZF90cnVzdF9sZXZlbCxcbiAgICAgICAgICAgIFwidXNlcl90cnVzdF92YWxfYWZ0ZXJcIjogdXNlcl9yZXBvcnRlZF90cnVzdF9sZXZlbCxcbiAgICAgICAgICAgIFwiaW5pdGlhbF91c2VyX2RlY2lzaW9uXCI6IGluaXRpYWxfdXNlcl9kZWNpc2lvbixcbiAgICAgICAgICAgIFwiZmluYWxfdXNlcl9kZWNpc2lvblwiOiBmaW5hbF91c2VyX2RlY2lzaW9uLFxuICAgICAgICAgICAgXCJpbml0aWFsX3VzZXJfY29uZmlkZW5jZVwiOiBpbml0aWFsX3VzZXJfY29uZmlkZW5jZSxcbiAgICAgICAgICAgIFwiZmluYWxfdXNlcl9jb25maWRlbmNlXCI6IGZpbmFsX3VzZXJfY29uZmlkZW5jZSxcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZ2dlZF9kYXRhWyd0aW1lcyddID0ge1xuICAgICAgICAgICAgXCJpbml0aWFsX2RlY2lzaW9uXCI6IHRpbWVfaW5pdGlhbF9jb25maWRlbmNlX3N0YXJ0IC0gdGltZV9xdWVzdGlvbl9zdGFydCxcbiAgICAgICAgICAgIFwiaW5pdGlhbF9jb25maWRlbmNlXCI6IHRpbWVfZmluYWxfZGVjaXNpb25fc3RhcnQgLSB0aW1lX2luaXRpYWxfY29uZmlkZW5jZV9zdGFydCxcbiAgICAgICAgICAgIFwiZmluYWxfZGVjaXNpb25cIjogdGltZV9maW5hbF9jb25maWRlbmNlX3N0YXJ0IC0gdGltZV9maW5hbF9kZWNpc2lvbl9zdGFydCxcbiAgICAgICAgICAgIFwiZmluYWxfY29uZmlkZW5jZVwiOiB0aW1lX3RydXN0X2RlY2lzaW9uX3N0YXJ0IC0gdGltZV9maW5hbF9jb25maWRlbmNlX3N0YXJ0LFxuICAgICAgICAgICAgXCJ0cnVzdF9kZWNpc2lvblwiOiBEYXRlLm5vdygpIC0gdGltZV90cnVzdF9kZWNpc2lvbl9zdGFydCxcbiAgICAgICAgfVxuICAgICAgICBsb2dnZWRfZGF0YVsncXVlc3Rpb24nXSA9IHF1ZXN0aW9uXG4gICAgICAgIGxvZ2dlZF9kYXRhWydjb3VudF9leGl0ZWRfcGFnZSddID0gY291bnRfZXhpdGVkX3BhZ2VcbiAgICAgICAgbG9nZ2VkX2RhdGFbJ2ludGVydmVudGlvbl9kZXRhaWxzJ10gPSBpbnRlcnZlbnRpb25fZGV0YWlsc1xuICAgICAgICBsb2dnZWRfZGF0YVsndHJ1c3RfZWZmZWN0X3ByZWRpY3Rpb25fZGF0YSddID0gdHJ1c3RfZWZmZWN0X3ByZWRpY3Rpb25fZGF0YVxuICAgICAgICBsb2dfZGF0YShsb2dnZWRfZGF0YSlcbiAgICAgICAgY291bnRfZXhpdGVkX3BhZ2UgPSAwXG5cbiAgICB9XG4gICAgbmV4dF9xdWVzdGlvbigpXG59KTtcblxuJCgnI3JhbmdlX3ZhbCcpLm9uKCdpbnB1dCBjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgdXNlcl9yZXBvcnRlZF90cnVzdF9sZXZlbCA9ICgkKHRoaXMpLnZhbCgpISBhcyBudW1iZXIpXG4gICAgJChcIiNyYW5nZV90ZXh0XCIpLnRleHQoYEFmdGVyIHRoaXMgaW50ZXJhY3Rpb24sIHlvdXIgY3VycmVudCB0cnVzdCBpbiB0aGUgQUk6ICR7dXNlcl9yZXBvcnRlZF90cnVzdF9sZXZlbCAqIDEwfSAvIDEwMC5gKVxuICAgICQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXG59KTtcblxuZnVuY3Rpb24gbWFrZV9pbml0aWFsX3VzZXJfZGVjaXNpb24ob3B0aW9uKSB7XG4gICAgdGltZV9pbml0aWFsX2NvbmZpZGVuY2Vfc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgaW5pdGlhbF91c2VyX2RlY2lzaW9uID0gb3B0aW9uXG4gICAgYXNzZXJ0KG9wdGlvbiA9PSAxIHx8IG9wdGlvbiA9PSAyLCBcIkludmFsaWQgb3B0aW9uIVwiKVxuICAgIGlmIChvcHRpb24gPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjFcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjJcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9kZWNpc2lvbl9vcHRpb24xXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjJcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cbiAgICAkKFwiI2luaXRpYWxfdXNlcl9jb25maWRlbmNlX2RpdlwiKS5zaG93KClcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjFcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2luaXRpYWxfZGVjaXNpb25fb3B0aW9uMlwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjNcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG59XG4kKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjFcIikub24oXCJjbGlja1wiLCAoKSA9PiBtYWtlX2luaXRpYWxfdXNlcl9kZWNpc2lvbigxKSlcbiQoXCIjYnV0dG9uX2luaXRpYWxfZGVjaXNpb25fb3B0aW9uMlwiKS5vbihcImNsaWNrXCIsICgpID0+IG1ha2VfaW5pdGlhbF91c2VyX2RlY2lzaW9uKDIpKVxuXG5mdW5jdGlvbiBnZXRfaW5pdGlhbF91c2VyX2NvbmZpZGVuY2UoY29uZl9sZXZlbCkge1xuICAgIHRpbWVfZmluYWxfZGVjaXNpb25fc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgaW5pdGlhbF91c2VyX2NvbmZpZGVuY2UgPSBjb25mX2xldmVsXG4gICAgYXNzZXJ0KGNvbmZfbGV2ZWwgPT0gMSB8fCBjb25mX2xldmVsID09IDIgfHwgY29uZl9sZXZlbCA9PSAzLCBcIkludmFsaWQgb3B0aW9uIVwiKVxuICAgIGlmIChjb25mX2xldmVsID09IDEpIHtcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjFcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgfSBlbHNlIGlmIChjb25mX2xldmVsID09IDIpIHtcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgICAgICQoXCIjYnV0dG9uX2luaXRpYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjNcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgICAgICQoXCIjYnV0dG9uX2luaXRpYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgfVxuXG4gICAgJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjFcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2luaXRpYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9maW5hbF9kZWNpc2lvbl9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKSAgICBcblxuICAgIGdldF9haV9hc3Npc3RhbmNlKClcbn1cbiQoXCIjYnV0dG9uX2luaXRpYWxfY29uZmlkZW5jZV9vcHRpb24xXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gZ2V0X2luaXRpYWxfdXNlcl9jb25maWRlbmNlKDEpKVxuJChcIiNidXR0b25faW5pdGlhbF9jb25maWRlbmNlX29wdGlvbjJcIikub24oXCJjbGlja1wiLCAoKSA9PiBnZXRfaW5pdGlhbF91c2VyX2NvbmZpZGVuY2UoMikpXG4kKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5vbihcImNsaWNrXCIsICgpID0+IGdldF9pbml0aWFsX3VzZXJfY29uZmlkZW5jZSgzKSlcblxuXG5cbmFzeW5jIGZ1bmN0aW9uIGdldF91c2VyX2RlY2lzaW9uX3Byb2IoKSB7XG4gICAgLy8gUHJlcGFyZSBpbnB1dHMgZm9yIHRoZSB1c2VyIGRlY2lzaW9uIG1vZGVsXG4gICAgbGV0IHVzZXJfYWlfaW5pdGlhbF9hZ3JlZW1lbnQgPSBOdW1iZXIoaW5pdGlhbF91c2VyX2RlY2lzaW9uID09IHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0pXG4gICAgbGV0IHVzZXJfaW5pdGlhbF9jb25maWRlbmNlID0gaW5pdGlhbF91c2VyX2NvbmZpZGVuY2VcbiAgICBsZXQgYWlfY29uZmlkZW5jZSA9IE51bWJlcihxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMFxuICAgIGxldCB1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWwgPSB1c2VyX2N1cnJlbnRfZXN0aW1hdGVkX3RydXN0X2xldmVsXG4gICAgaWYgKHVzZVVzZXJSZXBvcnRlZFRydXN0VmFsKSB7XG4gICAgICAgIHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA9ICh1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsIC0gNSkgLyAyLjVcbiAgICB9XG4gICAgbGV0IHVzZXJfZGVjaXNpb25fbW9kZWxfaW5wdXRzID0ge1xuICAgICAgICBcInVzZXJfYWlfaW5pdGlhbF9hZ3JlZW1lbnRcIjogdXNlcl9haV9pbml0aWFsX2FncmVlbWVudCxcbiAgICAgICAgXCJ1c2VyX2luaXRpYWxfY29uZmlkZW5jZVwiOiB1c2VyX2luaXRpYWxfY29uZmlkZW5jZSxcbiAgICAgICAgXCJhaV9jb25maWRlbmNlXCI6IGFpX2NvbmZpZGVuY2UsXG4gICAgICAgIFwidXNlcl9jdXJyZW50X3RydXN0X2xldmVsXCI6IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCxcbiAgICAgICAgXCJ0aW1lc3RlcFwiOiBxdWVzdGlvbl9pLFxuICAgIH1cblxuICAgIGxldCByZXN1bHQ6IGFueVxuICAgIHRyeSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0ICQuYWpheChcbiAgICAgICAgICAgIFVTRVJfTU9ERUxTX1JPT1QgKyBcImdldF91c2VyX2RlY2lzaW9uX3Byb2JcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6IFwiMnN0ZXAtdHJ1c3Qtc3R1ZHlcIixcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxfbmFtZTogdXNlcl9kZWNpc2lvbl9tb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZDogSlNPTi5zdHJpbmdpZnkodXNlcl9kZWNpc2lvbl9tb2RlbF9pbnB1dHMpLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkVSUk9SIVwiKVxuICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBcInVzZXJfZGVjaXNpb25fbW9kZWxfaW5wdXRzXCI6IHVzZXJfZGVjaXNpb25fbW9kZWxfaW5wdXRzLCBcbiAgICAgICAgXCJ1c2VyX2FjY2VwdGFuY2VfbGlrZWxpaG9vZFwiOiByZXN1bHRbXCJwcmVkX3Byb2JzXCJdWzBdWzFdXG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBleGFtaW5lX2VmZmVjdF9vZl90cnVzdF9vbl9kZWNpc2lvbl9tYWtpbmcoKSB7XG4gICAgLy8gUHJlcGFyZSBpbnB1dCB2YXJpYWJsZXMgZm9yIHVzZXIgZGVjaXNpb24gbW9kZWxcbiAgICBsZXQgdXNlcl9haV9pbml0aWFsX2FncmVlbWVudCA9IE51bWJlcihpbml0aWFsX3VzZXJfZGVjaXNpb24gPT0gcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSlcbiAgICBsZXQgdXNlcl9pbml0aWFsX2NvbmZpZGVuY2UgPSBpbml0aWFsX3VzZXJfY29uZmlkZW5jZVxuICAgIGxldCBhaV9jb25maWRlbmNlID0gTnVtYmVyKHF1ZXN0aW9uIVtcImFpX2NvbmZpZGVuY2VcIl0ucmVwbGFjZShcIiVcIiwgXCJcIikpIC8gMTAwXG4gICAgbGV0IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA9IHVzZXJfY3VycmVudF9lc3RpbWF0ZWRfdHJ1c3RfbGV2ZWxcbiAgICBpZiAodXNlVXNlclJlcG9ydGVkVHJ1c3RWYWwpIHtcbiAgICAgICAgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsID0gKHVzZXJfcmVwb3J0ZWRfdHJ1c3RfbGV2ZWwgLSA1KSAvIDIuNVxuICAgIH1cbiAgICBsZXQgdXNlcl9kZWNpc2lvbl9tb2RlbF9pbnB1dHMgPSB7XG4gICAgICAgIFwidXNlcl9haV9pbml0aWFsX2FncmVlbWVudFwiOiB1c2VyX2FpX2luaXRpYWxfYWdyZWVtZW50LFxuICAgICAgICBcInVzZXJfaW5pdGlhbF9jb25maWRlbmNlXCI6IHVzZXJfaW5pdGlhbF9jb25maWRlbmNlLFxuICAgICAgICBcImFpX2NvbmZpZGVuY2VcIjogYWlfY29uZmlkZW5jZSxcbiAgICAgICAgXCJ1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWxcIjogdXNlcl9jdXJyZW50X3RydXN0X2xldmVsLFxuICAgICAgICBcInRpbWVzdGVwXCI6IHF1ZXN0aW9uX2ksXG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwiVXNlciBkZWNpc2lvbiBtb2RlbCBpbnB1dHM6IFwiLCB1c2VyX2RlY2lzaW9uX21vZGVsX2lucHV0cylcblxuICAgIGxldCBhbGRpZmZfcmVzdWx0OiBhbnlcbiAgICB0cnkge1xuICAgICAgICBhbGRpZmZfcmVzdWx0ID0gYXdhaXQgJC5hamF4KFxuICAgICAgICAgICAgVVNFUl9NT0RFTFNfUk9PVCArIFwiZXhhbWluZV9lZmZlY3Rfb2ZfdHJ1c3Rfb25fZGVjaXNpb25fbWFraW5nXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcIjJzdGVwLXRydXN0LXN0dWR5XCIsXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsX25hbWU6IHVzZXJfZGVjaXNpb25fbW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KHVzZXJfZGVjaXNpb25fbW9kZWxfaW5wdXRzKSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUiFcIilcbiAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICB9XG5cbiAgICByZXR1cm4gYWxkaWZmX3Jlc3VsdFxufVxuXG5hc3luYyBmdW5jdGlvbiBmaW5kX2Jlc3RfYWljb25mX3RvX2Rpc3BsYXkodXNlcl9hY2NlcHRhbmNlX2xpa2VsaWhvb2RfbmV1dHJhbF90cnVzdCkge1xuICAgIC8vIFByZXBhcmUgaW5wdXQgdmFyaWFibGVzIGZvciB1c2VyIGRlY2lzaW9uIG1vZGVsXG4gICAgbGV0IHVzZXJfYWlfaW5pdGlhbF9hZ3JlZW1lbnQgPSBOdW1iZXIoaW5pdGlhbF91c2VyX2RlY2lzaW9uID09IHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0pXG4gICAgbGV0IHVzZXJfaW5pdGlhbF9jb25maWRlbmNlID0gaW5pdGlhbF91c2VyX2NvbmZpZGVuY2VcbiAgICBsZXQgYWlfY29uZmlkZW5jZSA9IE51bWJlcihxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMFxuICAgIGxldCB1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWwgPSB1c2VyX2N1cnJlbnRfZXN0aW1hdGVkX3RydXN0X2xldmVsXG4gICAgaWYgKHVzZVVzZXJSZXBvcnRlZFRydXN0VmFsKSB7XG4gICAgICAgIHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA9ICh1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsIC0gNSkgLyAyLjVcbiAgICB9XG4gICAgbGV0IGZpbmRuZXdjb25mX2lucHV0X3ZhcmlhYmxlcyA9IHtcbiAgICAgICAgXCJ1c2VyX2FpX2luaXRpYWxfYWdyZWVtZW50XCI6IHVzZXJfYWlfaW5pdGlhbF9hZ3JlZW1lbnQsXG4gICAgICAgIFwidXNlcl9pbml0aWFsX2NvbmZpZGVuY2VcIjogdXNlcl9pbml0aWFsX2NvbmZpZGVuY2UsXG4gICAgICAgIFwidXNlcl9jdXJyZW50X3RydXN0X2xldmVsXCI6IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCxcbiAgICAgICAgXCJ0aW1lc3RlcFwiOiBxdWVzdGlvbl9pLFxuICAgICAgICBcInVzZXJfYWNjZXB0YW5jZV9saWtlbGlob29kX25ldXRyYWxfdHJ1c3RcIjogdXNlcl9hY2NlcHRhbmNlX2xpa2VsaWhvb2RfbmV1dHJhbF90cnVzdCxcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgZmluZG5ld2NvbmZfcmVzdWx0ID0gYXdhaXQgJC5hamF4KFxuICAgICAgICAgICAgVVNFUl9NT0RFTFNfUk9PVCArIFwiZmluZF9iZXN0X2FpY29uZl90b19kaXNwbGF5XCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiBcIjJzdGVwLXRydXN0LXN0dWR5XCIsXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsX25hbWU6IHVzZXJfZGVjaXNpb25fbW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQ6IEpTT04uc3RyaW5naWZ5KGZpbmRuZXdjb25mX2lucHV0X3ZhcmlhYmxlcyksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1IhXCIpXG4gICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbmRuZXdjb25mX3Jlc3VsdFxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRfYWlfYXNzaXN0YW5jZV9vbGQoKSB7XG4gICAgY29uc29sZS5sb2coXCJHZXR0aW5nIEFJIGFzc2lzdGFuY2UuLi5cIilcblxuICAgIGludGVydmVudGlvbl9kZXRhaWxzID0ge31cbiAgICBsZXQgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgbGV0IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA9IHVzZXJfY3VycmVudF9lc3RpbWF0ZWRfdHJ1c3RfbGV2ZWxcbiAgICBpZiAodXNlVXNlclJlcG9ydGVkVHJ1c3RWYWwpIHtcbiAgICAgICAgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsID0gKHVzZXJfcmVwb3J0ZWRfdHJ1c3RfbGV2ZWwgLSA1KSAvIDIuNVxuICAgICAgICBjb25zb2xlLmxvZyhcIlVzaW5nIHVzZXIgcmVwb3J0ZWQgdHJ1c3QgdmFsdWU6IFwiLCB1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsKVxuICAgIH1cblxuICAgIGlmIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJub25lXCIpIHtcbiAgICAgICAgLy8gTm8gaW50ZXJ2ZW50aW9uLCBqdXN0IHNob3cgdGhlIEFJIGFzc2lzdGFuY2UgdGhhdCBpcyBhbHJlYWR5IHBvcHVsYXRlZCBpbiB0aGUgc3BhblxuICAgICAgICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSA9IHF1ZXN0aW9uIVtcImFpX2NvbmZpZGVuY2VcIl1cbiAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHMgPSB7fVxuICAgIH0gXG4gICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25Hb2FsID09IFwibWl0aWdhdGVfdW5kZXJ0cnVzdFwiKSB7XG5cbiAgICAgICAgaWYgKHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA8IDApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGFsZGlmZl9yZXN1bHQgPSBhd2FpdCBleGFtaW5lX2VmZmVjdF9vZl90cnVzdF9vbl9kZWNpc2lvbl9tYWtpbmcoKSAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGFsX2RpZmYgPSBhbGRpZmZfcmVzdWx0W1wiYWxfZGlmZlwiXVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyJ3MgbGlrZWxpaG9vZCBvZiBnb2luZyB3aXRoIHRoZSBBSSdzIHByZWRpY3Rpb246IFwiLCBhbGRpZmZfcmVzdWx0W1wiYWN0dWFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdKVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyJ3MgbGlrZWxpaG9vZCBvZiBnb2luZyB3aXRoIHRoZSBBSSdzIHByZWRpY3Rpb24gd2l0aCBuZXV0cmFsIHRydXN0OiBcIiwgYWxkaWZmX3Jlc3VsdFtcIm5ldXRyYWxfdHJ1c3RcIl1bXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2RcIl0pXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFjY2VwdGFuY2UgTGlrZWxpaG9vZCBEaWZmOiBcIiwgYWxfZGlmZilcbiAgICAgICAgICAgIGxldCB1c2VyX2FjY2VwdGFuY2VfbGlrZWxpaG9vZF9uZXV0cmFsX3RydXN0ID0gYWxkaWZmX3Jlc3VsdFtcIm5ldXRyYWxfdHJ1c3RcIl1bXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2RcIl1cbiAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiYWNjZXB0YW5jZV9saWtlbGlob29kX3Jlc3VsdHNcIl0gPSBhbGRpZmZfcmVzdWx0XG5cbiAgICAgICAgICAgIGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkID0gZmFsc2VcbiAgICAgICAgICAgIGlmIChhbF9kaWZmID49IEludGVydmVudGlvbkFMRGlmZlRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fY29uZGl0aW9uX3NhdGlzZmllZFwiXSA9IGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkludGVydmVudGlvbiBjb25kaXRpb24gc2F0aXNmaWVkOiBcIiwgaW50ZXJ2ZW50aW9uX2NvbmRpdGlvbl9zYXRpc2ZpZWQpXG5cbiAgICAgICAgICAgIGlmIChBSUludGVydmVudGlvblN0cmF0ZWd5ID09IFwiZml4ZWRcIiAmJiBpbml0aWFsX3VzZXJfZGVjaXNpb24gIT0gcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSkge1xuICAgICAgICAgICAgICAgIC8vIEZpeGVkIGludGVydmVudGlvbiBzdHJhdGVneSBpcyBhcHBsaWVkIHdoZW5ldmVyOlxuICAgICAgICAgICAgICAgIC8vIDEuIHRoZSB1c2VyJ3MgdHJ1c3QgaXMgbmVnYXRpdmUsIGFuZFxuICAgICAgICAgICAgICAgIC8vIDIuIHRoZSB1c2VyJ3MgaW5pdGlhbCBkZWNpc2lvbiBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgQUkncyBwcmVkaWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbnRlcnZlbnRpb24gYWxsb3dlZDpcIiwgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzLmluY2x1ZGVzKHF1ZXN0aW9uX2kpKVxuICAgICAgICAgICAgICAgIGlmICghKGludGVydmVudGlvbl9hbGxvd2VkX3RpbWVzdGVwcy5pbmNsdWRlcyhxdWVzdGlvbl9pKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbnRlcnZlbnRpb24gbm90IGFsbG93ZWQgYXQgdGhpcyB0aW1lc3RlcFwiKVxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSA9IHF1ZXN0aW9uIVtcImFpX2NvbmZpZGVuY2VcIl1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJjb25maWRlbmNlX21hbmlwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluY3JlYXNlIEFJIGNvbmZpZGVuY2UgYnkgZml4ZWQgYW1vdW50XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWlfY29uZmlkZW5jZSA9IE51bWJlcihxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld19jb25maWRlbmNlID0gTWF0aC5taW4oMSwgYWlfY29uZmlkZW5jZSArIEludGVydmVudGlvbkZpeGVkQ29uZkNoYW5nZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXllZF9haV9jb25maWRlbmNlID0gU3RyaW5nKCggbmV3X2NvbmZpZGVuY2UgKiAxMDApLnRvRml4ZWQoMCkpICsgXCIlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb25maWRlbmNlX2luZmxhdGlvbiA9IChuZXdfY29uZmlkZW5jZSAtIGFpX2NvbmZpZGVuY2UpLnRvRml4ZWQoMilcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJjb25mX2FjdHVhbFwiXSA9IHF1ZXN0aW9uIVtcImFpX2NvbmZpZGVuY2VcIl1cbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9uZXdcIl0gPSBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJjb25mX2luZmxhdGlvblwiXSA9IGNvbmZpZGVuY2VfaW5mbGF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiYWNjZXB0YW5jZV9saWtlbGlob29kLWFjdHVhbGNvbmZfYWN0dWFsdHJ1c3RcIl0gPSBhbGRpZmZfcmVzdWx0W1wiYWN0dWFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImFjY2VwdGFuY2VfbGlrZWxpaG9vZC1hY3R1YWxjb25mX25ldXRyYWx0cnVzdFwiXSA9IGFsZGlmZl9yZXN1bHRbXCJuZXV0cmFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJhaV9leHBsYW5hdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgQUkgZXhwbGFuYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2hvd2luZyBleHBsYW5hdGlvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV4cGxhbmF0aW9uX3Nob3duOiBzdHJpbmcgPSAhcXVlc3Rpb24hW1wiYWlfZXhwbGFuYXRpb25cIl0gPyBcIk5vIGV4cGxhbmF0aW9uIHByb3ZpZGVkXCIgOiBxdWVzdGlvbiFbXCJhaV9leHBsYW5hdGlvblwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNhaV9leHBsYW5hdGlvbl9zcGFuXCIpLmh0bWwoZXhwbGFuYXRpb25fc2hvd24pXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2RpdlwiKS5zaG93KClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiZXhwbGFuYXRpb25fc2hvd25cIl0gPSBleHBsYW5hdGlvbl9zaG93blxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IFwibm9uZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25TdHJhdGVneSA9PSBcImFkYXB0aXZlXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkludGVydmVudGlvbiBjb25kaXRpb24gc2F0aXNmaWVkOiBcIiwgaW50ZXJ2ZW50aW9uX2NvbmRpdGlvbl9zYXRpc2ZpZWQpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbnRlcnZlbnRpb24gYWxsb3dlZDpcIiwgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzLmluY2x1ZGVzKHF1ZXN0aW9uX2kpKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHF1ZXN0aW9uX2ksIGludGVydmVudGlvbl9hbGxvd2VkX3RpbWVzdGVwcylcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJ2ZW50aW9uX2NvbmRpdGlvbl9zYXRpc2ZpZWQgJiYgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzLmluY2x1ZGVzKHF1ZXN0aW9uX2kpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJjb25maWRlbmNlX21hbmlwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vRmluZCBuZWFyZXN0IEFJIGNvbmZpZGVuY2Ugd2l0aCBtaW5pbWl6aW5nIEFMRGlmZlxuICAgICAgICAgICAgICAgICAgICAgICAgZmluZG5ld2NvbmZfcmVzdWx0ID0gYXdhaXQgZmluZF9iZXN0X2FpY29uZl90b19kaXNwbGF5KHVzZXJfYWNjZXB0YW5jZV9saWtlbGlob29kX25ldXRyYWxfdHJ1c3QpXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSA9IFN0cmluZygoZmluZG5ld2NvbmZfcmVzdWx0WyduZXdfY29uZl90b19kaXNwbGF5J10gKiAxMDApLnRvRml4ZWQoMCkpICsgXCIlXCIgIC8vIENvbmZpZGVuY2UgaW4gQUkncyBwcmVkaWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWlfY29uZmlkZW5jZSA9IE51bWJlcihxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbmZpZGVuY2VfaW5mbGF0aW9uID0gKGZpbmRuZXdjb25mX3Jlc3VsdFsnbmV3X2NvbmZfdG9fZGlzcGxheSddIC0gYWlfY29uZmlkZW5jZSkudG9GaXhlZCgyKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImZpbmRuZXdjb25mX3Jlc3VsdHNcIl0gPSBmaW5kbmV3Y29uZl9yZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9hY3R1YWxcIl0gPSAgcXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJjb25mX25ld1wiXSA9ICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJjb25mX2luZmxhdGlvblwiXSA9IGNvbmZpZGVuY2VfaW5mbGF0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiYWNjZXB0YW5jZV9saWtlbGlob29kLWFjdHVhbGNvbmZfYWN0dWFsdHJ1c3RcIl0gPSAgYWxkaWZmX3Jlc3VsdFtcImFjdHVhbF90cnVzdFwiXVtcImFjY2VwdGFuY2VfbGlrZWxpaG9vZFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2QtYWN0dWFsY29uZl9uZXV0cmFsdHJ1c3RcIl0gPSBhbGRpZmZfcmVzdWx0W1wibmV1dHJhbF90cnVzdFwiXVtcImFjY2VwdGFuY2VfbGlrZWxpaG9vZFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2QtbmV3Y29uZl9hY3R1YWx0cnVzdFwiXSA9IGZpbmRuZXdjb25mX3Jlc3VsdFtcIm5ld19jb25mX2FjY2VwdGFuY2VfbGlrZWxpaG9vZFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJhaV9leHBsYW5hdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgQUkgZXhwbGFuYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2hvd2luZyBleHBsYW5hdGlvblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV4cGxhbmF0aW9uX3Nob3duOiBzdHJpbmcgPSAhcXVlc3Rpb24hW1wiYWlfZXhwbGFuYXRpb25cIl0gPyBcIk5vIGV4cGxhbmF0aW9uIHByb3ZpZGVkXCIgOiBxdWVzdGlvbiFbXCJhaV9leHBsYW5hdGlvblwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNhaV9leHBsYW5hdGlvbl9zcGFuXCIpLmh0bWwoZXhwbGFuYXRpb25fc2hvd24pXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI2FpX2V4cGxhbmF0aW9uX2RpdlwiKS5zaG93KClcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiZXhwbGFuYXRpb25fc2hvd25cIl0gPSBleHBsYW5hdGlvbl9zaG93blxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IFwibm9uZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gZmFsc2VcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uR29hbCA9PSBcIm1pdGlnYXRlX292ZXJ0cnVzdFwiKSB7XG5cbiAgICAgICAgaWYgKHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA+IDApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGFsZGlmZl9yZXN1bHQgPSBhd2FpdCBleGFtaW5lX2VmZmVjdF9vZl90cnVzdF9vbl9kZWNpc2lvbl9tYWtpbmcoKSAgICAgICAgICAgIFxuICAgICAgICAgICAgbGV0IGFsX2RpZmYgPSBhbGRpZmZfcmVzdWx0W1wiYWxfZGlmZlwiXVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyJ3MgbGlrZWxpaG9vZCBvZiBnb2luZyB3aXRoIHRoZSBBSSdzIHByZWRpY3Rpb246IFwiLCBhbGRpZmZfcmVzdWx0W1wiYWN0dWFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdKVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJVc2VyJ3MgbGlrZWxpaG9vZCBvZiBnb2luZyB3aXRoIHRoZSBBSSdzIHByZWRpY3Rpb24gd2l0aCBuZXV0cmFsIHRydXN0OiBcIiwgYWxkaWZmX3Jlc3VsdFtcIm5ldXRyYWxfdHJ1c3RcIl1bXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2RcIl0pXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFjY2VwdGFuY2UgTGlrZWxpaG9vZCBEaWZmOiBcIiwgYWxfZGlmZilcbiAgICAgICAgICAgIGxldCB1c2VyX2FjY2VwdGFuY2VfbGlrZWxpaG9vZF9uZXV0cmFsX3RydXN0ID0gYWxkaWZmX3Jlc3VsdFtcIm5ldXRyYWxfdHJ1c3RcIl1bXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2RcIl1cbiAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiYWNjZXB0YW5jZV9saWtlbGlob29kX3Jlc3VsdHNcIl0gPSBhbGRpZmZfcmVzdWx0XG5cbiAgICAgICAgICAgIGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkID0gZmFsc2VcbiAgICAgICAgICAgIGlmIChhbF9kaWZmID49IEludGVydmVudGlvbkFMRGlmZlRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fY29uZGl0aW9uX3NhdGlzZmllZFwiXSA9IGludGVydmVudGlvbl9jb25kaXRpb25fc2F0aXNmaWVkXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoQUlJbnRlcnZlbnRpb25TdHJhdGVneSA9PSBcImZpeGVkXCIpIHtcblxuICAgICAgICAgICAgICAgIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJjb25maWRlbmNlX21hbmlwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVjcmVhc2UgQUkgY29uZmlkZW5jZSBieSBmaXhlZCBhbW91bnRcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFpX2NvbmZpZGVuY2UgPSBOdW1iZXIocXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXS5yZXBsYWNlKFwiJVwiLCBcIlwiKSkgLyAxMDBcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld19jb25maWRlbmNlID0gTWF0aC5tYXgoMC41LCBNYXRoLm1pbigxLCBhaV9jb25maWRlbmNlIC0gSW50ZXJ2ZW50aW9uRml4ZWRDb25mQ2hhbmdlKSlcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBTdHJpbmcoKCBuZXdfY29uZmlkZW5jZSAqIDEwMCkudG9GaXhlZCgwKSkgKyBcIiVcIlxuXG4gICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9hY3R1YWxcIl0gPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9uZXdcIl0gPSBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImFjY2VwdGFuY2VfbGlrZWxpaG9vZC1hY3R1YWxjb25mX2FjdHVhbHRydXN0XCJdID0gYWxkaWZmX3Jlc3VsdFtcImFjdHVhbF90cnVzdFwiXVtcImFjY2VwdGFuY2VfbGlrZWxpaG9vZFwiXVxuICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImFjY2VwdGFuY2VfbGlrZWxpaG9vZC1hY3R1YWxjb25mX25ldXRyYWx0cnVzdFwiXSA9IGFsZGlmZl9yZXN1bHRbXCJuZXV0cmFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiaW50ZXJ2ZW50aW9uX2FwcGxpZWRcIl0gPSB0cnVlXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChBSUludGVydmVudGlvblR5cGUgPT0gXCJhaV9leHBsYW5hdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCBBSSBleHBsYW5hdGlvblxuICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IFwibm9uZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiaW50ZXJ2ZW50aW9uX2FwcGxpZWRcIl0gPSBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgICBlbHNlIGlmIChBSUludGVydmVudGlvblN0cmF0ZWd5ID09IFwiYWRhcHRpdmVcIikge1xuICAgICAgICAgICAgICAgIGlmIChpbnRlcnZlbnRpb25fY29uZGl0aW9uX3NhdGlzZmllZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IFwiY29uZmlkZW5jZV9tYW5pcFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL0ZpbmQgbmVhcmVzdCBBSSBjb25maWRlbmNlIHdpdGggbWluaW1pemluZyBBTERpZmZcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRuZXdjb25mX3Jlc3VsdCA9IGF3YWl0IGZpbmRfYmVzdF9haWNvbmZfdG9fZGlzcGxheSh1c2VyX2FjY2VwdGFuY2VfbGlrZWxpaG9vZF9uZXV0cmFsX3RydXN0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBTdHJpbmcoKGZpbmRuZXdjb25mX3Jlc3VsdFsnbmV3X2NvbmZfdG9fZGlzcGxheSddICogMTAwKS50b0ZpeGVkKDApKSArIFwiJVwiICAvLyBDb25maWRlbmNlIGluIEFJJ3MgcHJlZGljdGlvblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImZpbmRuZXdjb25mX3Jlc3VsdHNcIl0gPSBmaW5kbmV3Y29uZl9yZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9hY3R1YWxcIl0gPSAgcXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJjb25mX25ld1wiXSA9ICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJhY2NlcHRhbmNlX2xpa2VsaWhvb2QtYWN0dWFsY29uZl9hY3R1YWx0cnVzdFwiXSA9ICBhbGRpZmZfcmVzdWx0W1wiYWN0dWFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImFjY2VwdGFuY2VfbGlrZWxpaG9vZC1hY3R1YWxjb25mX25ldXRyYWx0cnVzdFwiXSA9IGFsZGlmZl9yZXN1bHRbXCJuZXV0cmFsX3RydXN0XCJdW1wiYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImFjY2VwdGFuY2VfbGlrZWxpaG9vZC1uZXdjb25mX2FjdHVhbHRydXN0XCJdID0gZmluZG5ld2NvbmZfcmVzdWx0W1wibmV3X2NvbmZfYWNjZXB0YW5jZV9saWtlbGlob29kXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uVHlwZSA9PSBcImFpX2V4cGxhbmF0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBBSSBleHBsYW5hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IFwibm9uZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImludGVydmVudGlvbl9hcHBsaWVkXCJdID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlscyA9IHtcImludGVydmVudGlvbl9hcHBsaWVkXCI6IGZhbHNlfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1sndHJ1c3RfbGV2ZWxfYXRfc3RhcnRfb2ZfaW50ZXJhY3Rpb24nXSA9IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbFxuICAgIGludGVydmVudGlvbl9kZXRhaWxzWydhY3R1YWxfYWlfY29uZmlkZW5jZSddID0gcXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXVxuICAgIGludGVydmVudGlvbl9kZXRhaWxzWydkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSddID0gZGlzcGxheWVkX2FpX2NvbmZpZGVuY2VcbiAgICBjb25zb2xlLmxvZyhcIkFJIEFzc2lzdGFuY2UgSW50ZXJ2ZW50aW9uIERldGFpbHM6IFwiLCBpbnRlcnZlbnRpb25fZGV0YWlscylcblxuICAgICQoXCIjYWlfcHJlZGljdGlvbl9zcGFuXCIpLmh0bWwoXCJPcHRpb24gXCIgKyBxdWVzdGlvbiFbXCJhaV9wcmVkaWN0aW9uXCJdKVxuICAgICQoXCIjYWlfY29uZmlkZW5jZV9zcGFuXCIpLmh0bWwoZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UpXG5cbiAgICAkKFwiI2FpX2Fzc2lzdGFuY2VfZGl2XCIpLnNob3coKVxuICAgICQoXCIjZmluYWxfdXNlcl9kZWNpc2lvbl9kaXZcIikuc2hvdygpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldF9haV9hc3Npc3RhbmNlKCkge1xuICAgIGNvbnNvbGUubG9nKFwiR2V0dGluZyBBSSBhc3Npc3RhbmNlLi4uXCIpXG5cbiAgICBsZXQgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgbGV0IHVzZXJfY3VycmVudF90cnVzdF9sZXZlbCA9IHVzZXJfY3VycmVudF9lc3RpbWF0ZWRfdHJ1c3RfbGV2ZWxcbiAgICBpZiAodXNlVXNlclJlcG9ydGVkVHJ1c3RWYWwpIHtcbiAgICAgICAgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsID0gKHVzZXJfcmVwb3J0ZWRfdHJ1c3RfbGV2ZWwgLSA1KSAvIDIuNVxuICAgICAgICBjb25zb2xlLmxvZyhcIlVzaW5nIHVzZXIgcmVwb3J0ZWQgdHJ1c3QgdmFsdWU6IFwiLCB1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsKVxuICAgIH1cbiAgICBpbnRlcnZlbnRpb25fZGV0YWlscyA9IHtcbiAgICAgICAgXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiOiBmYWxzZSwgXG4gICAgICAgIFwidHJ1c3RfbGV2ZWxfYXRfc3RhcnRfb2ZfaW50ZXJhY3Rpb25cIjogdXNlcl9jdXJyZW50X3RydXN0X2xldmVsXG4gICAgXG4gICAgfVxuXG4gICAgaWYgKEFJSW50ZXJ2ZW50aW9uVHlwZSA9PSBcIm5vbmVcIiB8fCAoaW5pdGlhbF91c2VyX2RlY2lzaW9uID09IHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0pKSB7XG4gICAgICAgIC8vIE5vIGludGVydmVudGlvbiwganVzdCBzaG93IHRoZSBBSSBhc3Npc3RhbmNlIHRoYXQgaXMgYWxyZWFkeSBwb3B1bGF0ZWQgaW4gdGhlIHNwYW5cbiAgICAgICAgY29uc29sZS5sb2coXCJOb3QgYXBwbHlpbmcgYW55IGludGVydmVudGlvbi5cIilcbiAgICAgICAgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UgPSBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdXG4gICAgfVxuICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uVHlwZSA9PSBcImNvbmZpZGVuY2VfbWFuaXBcIikge1xuICAgICAgICAvLyBNb2RpZnkgQUkgY29uZmlkZW5jZVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJub25lXCIpIHx8IFxuICAgICAgICAgICAgKEFJSW50ZXJ2ZW50aW9uR29hbCA9PSBcIm1pdGlnYXRlX3VuZGVydHJ1c3RcIiAmJiB1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWwgPCBJbnRlcnZlbnRpb25UcnVzdFRocmVzaG9sZCkgfHxcbiAgICAgICAgICAgIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJtaXRpZ2F0ZV9vdmVydHJ1c3RcIiAmJiB1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWwgPiBJbnRlcnZlbnRpb25UcnVzdFRocmVzaG9sZClcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFwcGx5aW5nIEFJIGNvbmZpZGVuY2UgbWFuaXB1bGF0aW9uIGludGVydmVudGlvbi5cIilcbiAgICAgICAgICAgIGlmIChBSUludGVydmVudGlvblN0cmF0ZWd5ID09IFwiZml4ZWRcIikge1xuICAgICAgICAgICAgICAgIC8vIEFkZCBJbnRlcnZlbnRpb25GaXhlZENvbmZDaGFuZ2UgdG8gQUkncyBjb25maWRlbmNlXG4gICAgICAgICAgICAgICAgLy8gKEludGVydmVudGlvbkZpeGVkQ29uZkNoYW5nZSBjYW4gYmUgbmVnYXRpdmUpXG4gICAgICAgICAgICAgICAgbGV0IGFpX2NvbmZpZGVuY2UgPSBOdW1iZXIocXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXS5yZXBsYWNlKFwiJVwiLCBcIlwiKSkgLyAxMDBcbiAgICAgICAgICAgICAgICBsZXQgbmV3X2NvbmZpZGVuY2UgPSBNYXRoLm1pbigxLCBhaV9jb25maWRlbmNlICsgSW50ZXJ2ZW50aW9uRml4ZWRDb25mQ2hhbmdlKVxuICAgICAgICAgICAgICAgIG5ld19jb25maWRlbmNlID0gTWF0aC5tYXgoMC41LCBuZXdfY29uZmlkZW5jZSlcbiAgICAgICAgICAgICAgICBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSA9IFN0cmluZygoIG5ld19jb25maWRlbmNlICogMTAwKS50b0ZpeGVkKDApKSArIFwiJVwiXG4gICAgICAgICAgICAgICAgbGV0IGNvbmZpZGVuY2VfY2hhbmdlID0gKG5ld19jb25maWRlbmNlIC0gYWlfY29uZmlkZW5jZSkudG9GaXhlZCgyKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWN0dWFsIEFJIGNvbmZpZGVuY2U6IFwiLCBxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLCBcIiwgQ29uZmlkZW5jZSBzaG93biB0byB1c2VyOiBcIiwgZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UpXG5cbiAgICAgICAgICAgICAgICBpbnRlcnZlbnRpb25fZGV0YWlsc1tcImNvbmZfYWN0dWFsXCJdID0gcXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXVxuICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9kaXNwbGF5ZWRcIl0gPSBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiY29uZl9jaGFuZ2VcIl0gPSBjb25maWRlbmNlX2NoYW5nZVxuICAgICAgICAgICAgICAgIGludGVydmVudGlvbl9kZXRhaWxzW1wiaW50ZXJ2ZW50aW9uX2FwcGxpZWRcIl0gPSB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChBSUludGVydmVudGlvblN0cmF0ZWd5ID09IFwiYWRhcHRpdmVcIikge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IEltcGxlbWVudCBhZGFwdGl2ZSBzdHJhdGVneVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDb25kaXRpb25zIGZvciBhcHBseWluZyAnY29uZmlkZW5jZSBtYW5pcHVsYXRpb24nIGludGVydmVudGlvbiBub3Qgc2F0aXNmaWVkLlwiKVxuICAgICAgICB9XG5cbiAgICB9IFxuICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uVHlwZSA9PSBcImFpX2V4cGxhbmF0aW9uXCIpIHtcbiAgICAgICAgLy8gQWRkIEFJIGV4cGxhbmF0aW9uXG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgKEFJSW50ZXJ2ZW50aW9uR29hbCA9PSBcIm5vbmVcIikgfHxcbiAgICAgICAgICAgIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJtaXRpZ2F0ZV91bmRlcnRydXN0XCIgJiYgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsIDwgSW50ZXJ2ZW50aW9uVHJ1c3RUaHJlc2hvbGQpIHx8XG4gICAgICAgICAgICAoQUlJbnRlcnZlbnRpb25Hb2FsID09IFwibWl0aWdhdGVfb3ZlcnRydXN0XCIgJiYgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsID4gSW50ZXJ2ZW50aW9uVHJ1c3RUaHJlc2hvbGQpXG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBcHBseWluZyBBSSBleHBsYW5hdGlvbiBpbnRlcnZlbnRpb24uXCIpXG4gICAgICAgICAgICBpZiAoQUlJbnRlcnZlbnRpb25TdHJhdGVneSA9PSBcImZpeGVkXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgZXhwbGFuYXRpb25cIilcbiAgICAgICAgICAgICAgICBsZXQgZXhwbGFuYXRpb25fc2hvd246IHN0cmluZyA9ICFxdWVzdGlvbiFbXCJhaV9leHBsYW5hdGlvblwiXSA/IFwiTm8gZXhwbGFuYXRpb24gcHJvdmlkZWRcIiA6IHF1ZXN0aW9uIVtcImFpX2V4cGxhbmF0aW9uXCJdXG4gICAgICAgICAgICAgICAgJChcIiNhaV9leHBsYW5hdGlvbl9zcGFuXCIpLmh0bWwoZXhwbGFuYXRpb25fc2hvd24pXG4gICAgICAgICAgICAgICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuc2hvdygpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJleHBsYW5hdGlvbl9zaG93blwiXSA9IGV4cGxhbmF0aW9uX3Nob3duXG4gICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcblxuICAgICAgICAgICAgICAgIGNvbnN0IGFpX2V4cGxhbmF0aW9uX2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWlfZXhwbGFuYXRpb25fZGl2XCIpXG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMVwiKSxcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMlwiKSxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lcigxNSwgYWlfZXhwbGFuYXRpb25fZGl2LCBidXR0b25zLCBudWxsLCBcIlBsZWFzZSByZWFkIHRoZSBleHBsYW5hdGlvbi5cIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uU3RyYXRlZ3kgPT0gXCJhZGFwdGl2ZVwiKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogSW1wbGVtZW50IGFkYXB0aXZlIHN0cmF0ZWd5XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29uZGl0aW9ucyBmb3IgYXBwbHlpbmcgJ0FJIGV4cGxhbmF0aW9uJyBpbnRlcnZlbnRpb24gbm90IHNhdGlzZmllZC5cIilcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uVHlwZSA9PSBcImFpX2NvbnRyYXN0aXZlX2V4cGxhbmF0aW9uXCIpIHtcbiAgICAgICAgLy8gQWRkIEFJIGV4cGxhbmF0aW9uXG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgKEFJSW50ZXJ2ZW50aW9uR29hbCA9PSBcIm5vbmVcIikgfHxcbiAgICAgICAgICAgIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJtaXRpZ2F0ZV91bmRlcnRydXN0XCIgJiYgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsIDwgSW50ZXJ2ZW50aW9uVHJ1c3RUaHJlc2hvbGQpIHx8XG4gICAgICAgICAgICAoQUlJbnRlcnZlbnRpb25Hb2FsID09IFwibWl0aWdhdGVfb3ZlcnRydXN0XCIgJiYgdXNlcl9jdXJyZW50X3RydXN0X2xldmVsID4gSW50ZXJ2ZW50aW9uVHJ1c3RUaHJlc2hvbGQpXG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJBcHBseWluZyBBSSBleHBsYW5hdGlvbiBpbnRlcnZlbnRpb24uXCIpXG4gICAgICAgICAgICBpZiAoQUlJbnRlcnZlbnRpb25TdHJhdGVneSA9PSBcImZpeGVkXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNob3dpbmcgZXhwbGFuYXRpb25cIilcbiAgICAgICAgICAgICAgICBsZXQgZXhwbGFuYXRpb25fc2hvd246IHN0cmluZyA9ICFxdWVzdGlvbiFbXCJhaV9jb250cmFzdGl2ZV9leHBsYW5hdGlvblwiXSA/IFwiTm8gZXhwbGFuYXRpb24gcHJvdmlkZWRcIiA6IHF1ZXN0aW9uIVtcImFpX2NvbnRyYXN0aXZlX2V4cGxhbmF0aW9uXCJdXG4gICAgICAgICAgICAgICAgJChcIiNhaV9jb250cmFzdGl2ZV9leHBsYW5hdGlvbl9zcGFuXCIpLmh0bWwoZXhwbGFuYXRpb25fc2hvd24pXG4gICAgICAgICAgICAgICAgJChcIiNhaV9jb250cmFzdGl2ZV9leHBsYW5hdGlvbl9kaXZcIikuc2hvdygpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJleHBsYW5hdGlvbl9zaG93blwiXSA9IGV4cGxhbmF0aW9uX3Nob3duXG4gICAgICAgICAgICAgICAgaW50ZXJ2ZW50aW9uX2RldGFpbHNbXCJpbnRlcnZlbnRpb25fYXBwbGllZFwiXSA9IHRydWVcblxuICAgICAgICAgICAgICAgIGNvbnN0IGFpX2NvbnRyYXN0aXZlX2V4cGxhbmF0aW9uX2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWlfY29udHJhc3RpdmVfZXhwbGFuYXRpb25fZGl2XCIpXG4gICAgICAgICAgICAgICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMVwiKSxcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMlwiKSxcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lcigxMCwgYWlfY29udHJhc3RpdmVfZXhwbGFuYXRpb25fZGl2LCBidXR0b25zLCBudWxsLCBcIlBsZWFzZSByZWFkIHRoZSBleHBsYW5hdGlvbi5cIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEFJSW50ZXJ2ZW50aW9uU3RyYXRlZ3kgPT0gXCJhZGFwdGl2ZVwiKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogSW1wbGVtZW50IGFkYXB0aXZlIHN0cmF0ZWd5XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ29uZGl0aW9ucyBmb3IgYXBwbHlpbmcgJ0FJIGV4cGxhbmF0aW9uJyBpbnRlcnZlbnRpb24gbm90IHNhdGlzZmllZC5cIilcbiAgICAgICAgfVxuXG4gICAgfVxuXG5cbiAgICAvL2ludGVydmVudGlvbl9kZXRhaWxzWydhY3R1YWxfYWlfY29uZmlkZW5jZSddID0gcXVlc3Rpb24hW1wiYWlfY29uZmlkZW5jZVwiXVxuICAgIC8vaW50ZXJ2ZW50aW9uX2RldGFpbHNbJ2Rpc3BsYXllZF9haV9jb25maWRlbmNlJ10gPSBkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZVxuICAgIGNvbnNvbGUubG9nKFwiQUkgQXNzaXN0YW5jZSBJbnRlcnZlbnRpb24gRGV0YWlsczogXCIsIGludGVydmVudGlvbl9kZXRhaWxzKVxuXG4gICAgJChcIiNhaV9wcmVkaWN0aW9uX3NwYW5cIikuaHRtbChcIk9wdGlvbiBcIiArIHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0pXG4gICAgJChcIiNhaV9jb25maWRlbmNlX3NwYW5cIikuaHRtbChkaXNwbGF5ZWRfYWlfY29uZmlkZW5jZSlcblxuICAgICQoXCIjYWlfYXNzaXN0YW5jZV9kaXZcIikuc2hvdygpXG4gICAgJChcIiNmaW5hbF91c2VyX2RlY2lzaW9uX2RpdlwiKS5zaG93KClcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0X3RydXN0X2VmZmVjdCgpIHtcbiAgICAvLyBHZXQgdHJ1c3QgZWZmZWN0IGZvciB0aGlzIGludGVyYWN0aW9uXG4gICAgbGV0IGluaXRpYWxfdXNlcl9jb3JyZWN0bmVzcyA9IE51bWJlcihpbml0aWFsX3VzZXJfZGVjaXNpb24gPT0gcXVlc3Rpb24hW1wiY29ycmVjdF9vcHRpb25cIl0pXG4gICAgbGV0IGFpX2NvcnJlY3RuZXNzID0gTnVtYmVyKHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0gPT0gcXVlc3Rpb24hW1wiY29ycmVjdF9vcHRpb25cIl0pXG4gICAgbGV0IGZpbmFsX3VzZXJfY29ycmVjdG5lc3MgPSBOdW1iZXIoZmluYWxfdXNlcl9kZWNpc2lvbiA9PSBxdWVzdGlvbiFbXCJjb3JyZWN0X29wdGlvblwiXSlcbiAgICBsZXQgYWlfY29uZmlkZW5jZSA9IE51bWJlcihxdWVzdGlvbiFbXCJhaV9jb25maWRlbmNlXCJdLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMFxuICAgIGxldCB0cnVzdF9lZmZlY3RfaW5wdXRzID0ge1xuICAgICAgICBcImluaXRpYWxfdXNlcl9jb3JyZWN0bmVzc1wiOiBpbml0aWFsX3VzZXJfY29ycmVjdG5lc3MsXG4gICAgICAgIFwiYWlfY29ycmVjdG5lc3NcIjogYWlfY29ycmVjdG5lc3MsXG4gICAgICAgIFwiZmluYWxfdXNlcl9jb3JyZWN0bmVzc1wiOiBmaW5hbF91c2VyX2NvcnJlY3RuZXNzLFxuICAgICAgICBcImFpX2NvbmZpZGVuY2VcIjogYWlfY29uZmlkZW5jZSxcbiAgICAgICAgXCJ1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWxcIjogdXNlcl9jdXJyZW50X2VzdGltYXRlZF90cnVzdF9sZXZlbCxcbiAgICAgICAgXCJ0aW1lc3RlcFwiOiBxdWVzdGlvbl9pLFxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcIlRydXN0IGVmZmVjdCBpbnB1dHM6IFwiLCB0cnVzdF9lZmZlY3RfaW5wdXRzKVxuICAgIC8vbGV0IHRydXN0X2VmZmVjdCA9IGdldF91c2VyX3RydXN0X2VmZmVjdCh0cnVzdF9lZmZlY3RfaW5wdXRzKVxuICAgIGxldCByZXN1bHQ6IGFueVxuICAgIHRyeSB7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0ICQuYWpheChcbiAgICAgICAgICAgIFVTRVJfTU9ERUxTX1JPT1QgKyBcImdldF90cnVzdF9lZmZlY3RcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6IFwiMnN0ZXAtdHJ1c3Qtc3R1ZHlcIixcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxfbmFtZTogdHJ1c3RfZWZmZWN0X21vZGVsLFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiBKU09OLnN0cmluZ2lmeSh0cnVzdF9lZmZlY3RfaW5wdXRzKSxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUiFcIilcbiAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhcIlRydXN0IGVmZmVjdCBwcmVkaWN0aW9uIHJlc3VsdDogXCIsIHJlc3VsdClcbiAgICBsZXQgdHJ1c3RfZWZmZWN0ID0gYXdhaXQgcmVzdWx0W1widHJ1c3RfZWZmZWN0XCJdXG5cbiAgICB1c2VyX2N1cnJlbnRfZXN0aW1hdGVkX3RydXN0X2xldmVsID0gdXNlcl9jdXJyZW50X2VzdGltYXRlZF90cnVzdF9sZXZlbCArIHRydXN0X2VmZmVjdFxuICAgIHRydXN0X2VmZmVjdF9wcmVkaWN0aW9uX2RhdGEgPSB7XG4gICAgICAgIFwibW9kZWxfaW5wdXRzXCI6IHRydXN0X2VmZmVjdF9pbnB1dHMsXG4gICAgICAgIFwicHJlZGljdGVkX3RydXN0X2VmZmVjdFwiOiB0cnVzdF9lZmZlY3QsXG4gICAgICAgIFwidXNlcl9uZXdfdHJ1c3RfbGV2ZWxcIjogdXNlcl9jdXJyZW50X2VzdGltYXRlZF90cnVzdF9sZXZlbCxcbiAgICB9XG4gICAgcmV0dXJuIHRydXN0X2VmZmVjdF9wcmVkaWN0aW9uX2RhdGFcbn1cblxuZnVuY3Rpb24gbWFrZV9maW5hbF91c2VyX2RlY2lzaW9uKG9wdGlvbikge1xuICAgIHRpbWVfZmluYWxfY29uZmlkZW5jZV9zdGFydCA9IERhdGUubm93KClcbiAgICBmaW5hbF91c2VyX2RlY2lzaW9uID0gb3B0aW9uXG4gICAgYXNzZXJ0KG9wdGlvbiA9PSAxIHx8IG9wdGlvbiA9PSAyLCBcIkludmFsaWQgb3B0aW9uIVwiKVxuICAgIGlmIChvcHRpb24gPT0gMSkge1xuICAgICAgICAkKFwiI2J1dHRvbl9maW5hbF9kZWNpc2lvbl9vcHRpb24xXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICAgICAgJChcIiNidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiI2J1dHRvbl9maW5hbF9kZWNpc2lvbl9vcHRpb24xXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9maW5hbF9kZWNpc2lvbl9vcHRpb24yXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICB9XG4gICAgJChcIiNmaW5hbF91c2VyX2NvbmZpZGVuY2VfZGl2XCIpLnNob3coKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2RlY2lzaW9uX29wdGlvbjFcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2RlY2lzaW9uX29wdGlvbjJcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24zXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxufVxuJChcIiNidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMVwiKS5vbihcImNsaWNrXCIsICgpID0+IG1ha2VfZmluYWxfdXNlcl9kZWNpc2lvbigxKSlcbiQoXCIjYnV0dG9uX2ZpbmFsX2RlY2lzaW9uX29wdGlvbjJcIikub24oXCJjbGlja1wiLCAoKSA9PiBtYWtlX2ZpbmFsX3VzZXJfZGVjaXNpb24oMikpXG5cbmZ1bmN0aW9uIGdldF9maW5hbF91c2VyX2NvbmZpZGVuY2UoY29uZl9sZXZlbCkge1xuICAgIHRpbWVfdHJ1c3RfZGVjaXNpb25fc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgZmluYWxfdXNlcl9jb25maWRlbmNlID0gY29uZl9sZXZlbFxuICAgIGFzc2VydChjb25mX2xldmVsID09IDEgfHwgY29uZl9sZXZlbCA9PSAyIHx8IGNvbmZfbGV2ZWwgPT0gMywgXCJJbnZhbGlkIG9wdGlvbiFcIilcbiAgICBpZiAoY29uZl9sZXZlbCA9PSAxKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5hdHRyKFwiYWN0aXZlZGVjaXNpb25cIiwgXCJ0cnVlXCIpXG4gICAgICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAgICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24zXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgIH0gZWxzZSBpZiAoY29uZl9sZXZlbCA9PSAyKSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAgICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLmF0dHIoXCJhY3RpdmVkZWNpc2lvblwiLCBcInRydWVcIilcbiAgICAgICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24zXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAgICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICAgICAkKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjNcIikuYXR0cihcImFjdGl2ZWRlY2lzaW9uXCIsIFwidHJ1ZVwiKVxuICAgIH1cblxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbiAgICAkKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjNcIikuYXR0cihcImRpc2FibGVkXCIsIFwidHJ1ZVwiKVxuICAgIHNob3dfcmVzdWx0KClcbn1cbiQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5vbihcImNsaWNrXCIsICgpID0+IGdldF9maW5hbF91c2VyX2NvbmZpZGVuY2UoMSkpXG4kKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjJcIikub24oXCJjbGlja1wiLCAoKSA9PiBnZXRfZmluYWxfdXNlcl9jb25maWRlbmNlKDIpKVxuJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24zXCIpLm9uKFwiY2xpY2tcIiwgKCkgPT4gZ2V0X2ZpbmFsX3VzZXJfY29uZmlkZW5jZSgzKSlcblxuXG5hc3luYyBmdW5jdGlvbiBzaG93X3Jlc3VsdCgpIHtcblxuICAgIGxldCBjb3JyZWN0X29wdGlvbjogbnVtYmVyID0gcXVlc3Rpb24hW1wiY29ycmVjdF9vcHRpb25cIl1cbiAgICBsZXQgdXNlcl9pc19jb3JyZWN0OiBib29sZWFuID0gY29ycmVjdF9vcHRpb24gPT0gZmluYWxfdXNlcl9kZWNpc2lvblxuXG4gICAgbGV0IGFpX2lzX2NvcnJlY3Q6IGJvb2xlYW4gPSBxdWVzdGlvbiFbXCJhaV9pc19jb3JyZWN0XCJdXG4gICAgbGV0IG1lc3NhZ2UgPSBcIkNvcnJlY3QgYW5zd2VyOiA8Yj5PcHRpb24gXCIgKyBjb3JyZWN0X29wdGlvbiArIFwiPC9iPi48YnI+XCJcbiAgICBpZiAodXNlcl9pc19jb3JyZWN0KSB7XG4gICAgICAgIG1lc3NhZ2UgKz0gXCJZb3UgcGlja2VkIE9wdGlvbiBcIiArIGZpbmFsX3VzZXJfZGVjaXNpb24gKyBcIiwgd2hpY2ggd2FzIDxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBtZXNzYWdlICs9IFwiWW91IHBpY2tlZCBPcHRpb24gXCIgKyBmaW5hbF91c2VyX2RlY2lzaW9uICsgXCIsIHdoaWNoIHdhcyA8c3BhbiBjbGFzcz0nY29sb3JfaW5jb3JyZWN0Jz48Yj5pbmNvcnJlY3Q8L2I+PC9zcGFuPi48YnI+XCJcbiAgICB9XG4gICAgaWYgKGFpX2lzX2NvcnJlY3QpIHtcbiAgICAgICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2NvcnJlY3QnPjxiPmNvcnJlY3Q8Yj48L3NwYW4+Ljxicj5cIlxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbWVzc2FnZSArPSBcIlRoZSBBSSBwaWNrZWQgT3B0aW9uIFwiICsgcXVlc3Rpb24hW1wiYWlfcHJlZGljdGlvblwiXSArIFwiLCB3aGljaCB3YXMgPHNwYW4gY2xhc3M9J2NvbG9yX2luY29ycmVjdCc+PGI+aW5jb3JyZWN0PC9iPjwvc3Bhbj4uPGJyPlwiXG4gICAgfVxuICAgIGlmICh1c2VyX2lzX2NvcnJlY3QpIHtcbiAgICAgICAgbWVzc2FnZSArPSBcIjxzcGFuIGNsYXNzPSdjb2xvcl9jb3JyZWN0Jz48Yj5Zb3UgcmVjZWl2ZSBhIHJld2FyZCBvZiAkMC4xMC48L2I+PC9zcGFuPlwiXG4gICAgICAgIGJhbGFuY2UgKz0gMC4xXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBtZXNzYWdlICs9IFwiPHNwYW4gY2xhc3M9J2NvbG9yX2luY29ycmVjdCc+PGI+WW91IGRvIG5vdCByZWNlaXZlIGFueSByZXdhcmQuPC9iPjwvc3Bhbj5cIlxuICAgIH1cblxuICAgIG1lc3NhZ2UgKz0gXCI8YnI+XCJcbiAgICAvL2lmIChzdWNjZXNzKSB7XG4gICAgLy8gICAgbWVzc2FnZSArPSBgWW91IGdhaW4gJCR7KGJldF92YWwqYmV0X3ZhbF9yYXRpbykudG9GaXhlZCgyKX0uYFxuICAgIC8vICAgIGJhbGFuY2UgKz0gYmV0X3ZhbCpiZXRfdmFsX3JhdGlvXG4gICAgLy99IGVsc2Uge1xuICAgIC8vICAgIG1lc3NhZ2UgKz0gYFlvdSBsb3NlICQkeyhiZXRfdmFsLzEuMCkudG9GaXhlZCgyKX0uYFxuICAgIC8vICAgIGJhbGFuY2UgLT0gYmV0X3ZhbC8xLjBcbiAgICAvLyAgICBiYWxhbmNlID0gTWF0aC5tYXgoMCwgYmFsYW5jZSlcbiAgICAvL31cbiAgICAkKFwiI2JhbGFuY2VcIikudGV4dChgQmFsYW5jZTogJCR7YmFsYW5jZS50b0ZpeGVkKDIpfSArICQxLjBgKVxuICAgICQoXCIjcmVzdWx0X3NwYW5cIikuaHRtbChtZXNzYWdlKVxuICAgIC8vJChcIiNidXR0b25fbmV4dFwiKS5zaG93KClcbiAgICAkKFwiI3Jlc3VsdF9zcGFuXCIpLnNob3coKVxuICAgIC8vJChcIiNidXR0b25fcGxhY2VfYmV0XCIpLmhpZGUoKVxuICAgIGlmIChza2lwX3RydXN0X3JlcG9ydGluZykgICB7XG4gICAgICAgICQoXCIjYnV0dG9uX25leHRcIikuc2hvdygpXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAkKFwiI3VzZXJfdHJ1c3RfcmVwb3J0X2RpdlwiKS5zaG93KClcbiAgICB9XG5cbiAgICAvL3RydXN0X2VmZmVjdF9wcmVkaWN0aW9uX2RhdGEgPSBhd2FpdCBnZXRfdHJ1c3RfZWZmZWN0KClcblxuICAgIC8vJCgnI3JhbmdlX3ZhbCcpLmF0dHIoXCJkaXNhYmxlZFwiLCBcInRydWVcIilcbn1cblxuLy8kKFwiI2J1dHRvbl9wbGFjZV9iZXRcIikub24oXCJjbGlja1wiLCBzaG93X3Jlc3VsdClcblxuZnVuY3Rpb24gc3RhcnRfdGltZXJfZm9yX2luaXRpYWxfZGVjaXNpb24oKSB7XG4gICAgY29uc3QgaW5pdGlhbF91c2VyX2RlY2lzaW9uX2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5pdGlhbF91c2VyX2RlY2lzaW9uX2RpdlwiKVxuICAgIGNvbnN0IGJ1dHRvbnMgPSBbXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnV0dG9uX2luaXRpYWxfZGVjaXNpb25fb3B0aW9uMVwiKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidXR0b25faW5pdGlhbF9kZWNpc2lvbl9vcHRpb24yXCIpLFxuICAgIF1cbiAgICBzdGFydFRpbWVyKDEwLCBpbml0aWFsX3VzZXJfZGVjaXNpb25fZGl2LCBidXR0b25zLCBudWxsLCBcIlBsZWFzZSByZWFkIHRoZSBxdWVzdGlvbiBhbmQgb3B0aW9ucyBjbG9zZWx5LlwiKVxufVxuXG5mdW5jdGlvbiBuZXh0X3F1ZXN0aW9uKCkge1xuICAgIC8vIHJlc3RvcmUgcHJldmlvdXMgc3RhdGUgb2YgVUlcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25faW5pdGlhbF9kZWNpc2lvbl9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX2luaXRpYWxfZGVjaXNpb25fb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2RlY2lzaW9uX29wdGlvbjJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uMVwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcbiAgICAkKFwiI2J1dHRvbl9pbml0aWFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcblxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2RlY2lzaW9uX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfZGVjaXNpb25fb3B0aW9uMlwiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9maW5hbF9kZWNpc2lvbl9vcHRpb24xXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2RlY2lzaW9uX29wdGlvbjJcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG5cbiAgICAkKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImFjdGl2ZWRlY2lzaW9uXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJhY3RpdmVkZWNpc2lvblwiKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5yZW1vdmVBdHRyKFwiYWN0aXZlZGVjaXNpb25cIilcbiAgICAkKFwiI2J1dHRvbl9maW5hbF9jb25maWRlbmNlX29wdGlvbjFcIikucmVtb3ZlQXR0cihcImRpc2FibGVkXCIpXG4gICAgJChcIiNidXR0b25fZmluYWxfY29uZmlkZW5jZV9vcHRpb24yXCIpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjYnV0dG9uX2ZpbmFsX2NvbmZpZGVuY2Vfb3B0aW9uM1wiKS5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIilcblxuICAgICQoXCIjYWlfYXNzaXN0YW5jZV9kaXZcIikuaGlkZSgpXG4gICAgJChcIiNhaV9leHBsYW5hdGlvbl9kaXZcIikuaGlkZSgpXG4gICAgJChcIiNhaV9jb250cmFzdGl2ZV9leHBsYW5hdGlvbl9kaXZcIikuaGlkZSgpXG4gICAgJChcIiNpbml0aWFsX3VzZXJfY29uZmlkZW5jZV9kaXZcIikuaGlkZSgpXG4gICAgJChcIiNmaW5hbF91c2VyX2RlY2lzaW9uX2RpdlwiKS5oaWRlKClcbiAgICAkKFwiI2ZpbmFsX3VzZXJfY29uZmlkZW5jZV9kaXZcIikuaGlkZSgpXG4gICAgJCgnI3JhbmdlX3ZhbCcpLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKVxuICAgICQoXCIjdXNlcl90cnVzdF9yZXBvcnRfZGl2XCIpLmhpZGUoKVxuICAgICQoXCIjYnV0dG9uX3BsYWNlX2JldFwiKS5oaWRlKClcbiAgICAkKFwiI2J1dHRvbl9uZXh0XCIpLmhpZGUoKVxuICAgICQoXCIjcmVzdWx0X3NwYW5cIikuaGlkZSgpXG4gICAgaWYgKHF1ZXN0aW9uX2kgPT0gLTEpIHtcbiAgICAgICAgJChcIiNyYW5nZV90ZXh0XCIpLnRleHQoXCItXCIpXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAkKFwiI3JhbmdlX3RleHRcIikudGV4dChgQmVmb3JlIHRoaXMgaW50ZXJhY3Rpb24sIHlvdXIgdHJ1c3QgaW4gdGhlIEFJOiAke3VzZXJfcmVwb3J0ZWRfdHJ1c3RfbGV2ZWwgKiAxMH0gLyAxMDAuYClcbiAgICB9XG4gICAgJChcIiNyYW5nZV92YWxcIikudmFsKHVzZXJfcmVwb3J0ZWRfdHJ1c3RfbGV2ZWwpXG4gICAgcHJldl91c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsID0gdXNlcl9yZXBvcnRlZF90cnVzdF9sZXZlbFxuXG4gICAgcXVlc3Rpb25faSArPSAxXG4gICAgaWYgKHF1ZXN0aW9uX2kgPj0gZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgJChcIiNtYWluX2JveF9leHBlcmltZW50XCIpLmhpZGUoKVxuICAgICAgICBpZiAoTU9DS01PREUpIHtcbiAgICAgICAgICAgICQoXCIjbWFpbl9ib3hfZW5kX21vY2tcIikuc2hvdygpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKFwiI21haW5fYm94X2VuZFwiKS5zaG93KClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgcXVlc3Rpb24gPSBkYXRhW3F1ZXN0aW9uX2ldXG5cbiAgICAkKFwiI3F1ZXN0aW9uX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJxdWVzdGlvblwiXSlcbiAgICAkKFwiI29wdGlvbjFfc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcIm9wdGlvbjFcIl0pXG4gICAgJChcIiNvcHRpb24yX3NwYW5cIikuaHRtbChxdWVzdGlvbiFbXCJvcHRpb24yXCJdKVxuICAgIC8vJChcIiNhaV9wcmVkaWN0aW9uX3NwYW5cIikuaHRtbChcIk9wdGlvbiBcIiArIHF1ZXN0aW9uIVtcImFpX3ByZWRpY3Rpb25cIl0pXG4gICAgLy8kKFwiI2FpX2NvbmZpZGVuY2Vfc3BhblwiKS5odG1sKHF1ZXN0aW9uIVtcImFpX2NvbmZpZGVuY2VcIl0pXG5cbiAgICAvLyBzZXQgYmV0IHZhbHVlIHJhdGlvXG4gICAgaWYocXVlc3Rpb24uaGFzT3duUHJvcGVydHkoXCJyZXdhcmRfcmF0aW9cIikpIHtcbiAgICAgICAgbGV0IFtyYXRpbzEsIHJhdGlvMl0gPSBxdWVzdGlvbltcInJld2FyZF9yYXRpb1wiXVxuICAgICAgICByYXRpbzEgPSBOdW1iZXIocmF0aW8xKVxuICAgICAgICByYXRpbzIgPSBOdW1iZXIocmF0aW8yKVxuICAgICAgICBiZXRfdmFsX3JhdGlvID0gcmF0aW8xL3JhdGlvMlxuICAgIH0gZWxzZSB7XG4gICAgICAgIGJldF92YWxfcmF0aW8gPSAxXG4gICAgfVxuXG4gICAgdGltZV9xdWVzdGlvbl9zdGFydCA9IERhdGUubm93KClcbiAgICAkKFwiI3Byb2dyZXNzXCIpLnRleHQoYFByb2dyZXNzOiAke3F1ZXN0aW9uX2kgKyAxfSAvICR7ZGF0YS5sZW5ndGh9YClcblxuICAgIHN0YXJ0X3RpbWVyX2Zvcl9pbml0aWFsX2RlY2lzaW9uKClcbn1cblxuLy8gZ2V0IHVzZXIgaWQgYW5kIGxvYWQgcXVldWVcbi8vIHRyeSB0byBzZWUgaWYgc3RhcnQgb3ZlcnJpZGUgd2FzIHBhc3NlZFxuY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbmNvbnN0IHN0YXJ0T3ZlcnJpZGUgPSB1cmxQYXJhbXMuZ2V0KCdzdGFydCcpO1xuY29uc3QgVUlERnJvbVVSTCA9IHVybFBhcmFtcy5nZXQoXCJ1aWRcIilcbmdsb2JhbFRoaXMudXJsX2RhdGEgPSBwYXJhbXNUb09iamVjdCh1cmxQYXJhbXMuZW50cmllcygpKVxuXG5pZiAoVUlERnJvbVVSTCAhPSBudWxsKSB7XG4gICAgZ2xvYmFsVGhpcy51aWQgPSBVSURGcm9tVVJMIGFzIHN0cmluZ1xuICAgIGlmIChnbG9iYWxUaGlzLnVpZCA9PSBcInByb2xpZmljX3JhbmRvbVwiKSB7XG4gICAgICAgIGxldCBxdWV1ZV9pZCA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKX1gLnBhZFN0YXJ0KDMsIFwiMFwiKVxuICAgICAgICBnbG9iYWxUaGlzLnVpZCA9IGAke3VybFBhcmFtcy5nZXQoXCJwcm9saWZpY19xdWV1ZV9uYW1lXCIpfS8ke3F1ZXVlX2lkfWBcbiAgICB9XG59IGVsc2UgaWYgKERFVk1PREUpIHtcbiAgICBnbG9iYWxUaGlzLnVpZCA9IFwiZGVtb1wiXG59IGVsc2Uge1xuICAgIGxldCBVSURfbWF5YmU6IGFueSA9IG51bGxcbiAgICB3aGlsZSAoVUlEX21heWJlID09IG51bGwpIHtcbiAgICAgICAgVUlEX21heWJlID0gcHJvbXB0KFwiRW50ZXIgeW91ciB1c2VyIGlkLiBQbGVhc2UgZ2V0IGluIHRvdWNoIGlmIHlvdSB3ZXJlIG5vdCBhc3NpZ25lZCBhbiBpZCBidXQgd2lzaCB0byBwYXJ0aWNpcGF0ZSBpbiB0aGlzIGV4cGVyaW1lbnQuXCIpXG4gICAgfVxuICAgIGdsb2JhbFRoaXMudWlkID0gVUlEX21heWJlIVxufVxubGV0IGludGVydmVudGlvbl9hbGxvd2VkX3RpbWVzdGVwczogbnVtYmVyW10gPSBbXVxuaWYgKGdsb2JhbFRoaXMudWlkLmluY2x1ZGVzKFwiMzQzXCIpKSB7XG4gICAgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzID0gWzcsIDgsIDksIDE3LCAxOCwgMTksIDI3LCAyOCwgMjldXG59IGVsc2UgaWYgKGdsb2JhbFRoaXMudWlkLmluY2x1ZGVzKFwiNDM0XCIpKSB7XG4gICAgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzID0gWzcsIDgsIDksIDE3LCAxOCwgMTksIDI3LCAyOCwgMjldXG59IGVsc2UgaWYgKGdsb2JhbFRoaXMudWlkLmluY2x1ZGVzKFwiNzM1XCIpKSB7XG4gICAgaW50ZXJ2ZW50aW9uX2FsbG93ZWRfdGltZXN0ZXBzID0gWzEwLCAxMSwgMTIsIDEzLCAxNCwgMjUsIDI2LCAyNywgMjgsIDI5XVxufVxuXG4vL2NvbnN0IHZhbGlkQUlJbnRlcnZlbnRpb25zID0gW1wibm9uZVwiLCBcImR1bW15XCIsIFwiY29uZmlkZW5jZV9pbmZsYXRpb25cIiwgXCJjb25maWRlbmNlX2luZmxhdGlvbl9maXhlZFwiLCBcImNvbmZpZGVuY2VfZGVmbGF0aW9uXCJdXG4vL2xldCBBSUludGVydmVudGlvblR5cGUgPSB1cmxQYXJhbXMuZ2V0KFwiaW50ZXJ2ZW50aW9uX3R5cGVcIilcbi8vbGV0IEludGVydmVudGlvbkFMRGlmZlRocmVzaG9sZCA9IE51bWJlcih1cmxQYXJhbXMuZ2V0KFwiaW50ZXJ2ZW50aW9uX3RocmVzaG9sZFwiKSlcbi8vbGV0IEludGVydmVudGlvbkZpeGVkQ29uZkluY3JlYXNlID0gTnVtYmVyKHVybFBhcmFtcy5nZXQoXCJpbnRlcnZlbnRpb25fZml4ZWRjb25maW5jcmVhc2VcIikpXG5jb25zdCB2YWxpZEludGVydmVudGlvbkdvYWxzID0gW1wibm9uZVwiLCBcIm1pdGlnYXRlX3VuZGVydHJ1c3RcIiwgXCJtaXRpZ2F0ZV9vdmVydHJ1c3RcIl1cbmxldCBBSUludGVydmVudGlvbkdvYWwgPSB1cmxQYXJhbXMuZ2V0KFwiaW50ZXJ2ZW50aW9uX2dvYWxcIilcbmlmIChBSUludGVydmVudGlvbkdvYWwgPT0gbnVsbCkge0FJSW50ZXJ2ZW50aW9uR29hbCA9IFwibm9uZVwifVxuaWYgKCF2YWxpZEludGVydmVudGlvbkdvYWxzLmluY2x1ZGVzKEFJSW50ZXJ2ZW50aW9uR29hbCEpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBBSSBBc3Npc3RhbmNlIEludGVydmVudGlvbiBHb2FsOiBcIiArIEFJSW50ZXJ2ZW50aW9uR29hbClcbn1cblxuY29uc3QgdmFsaWRJbnRlcnZlbnRpb25UeXBlcyA9IFtcIm5vbmVcIiwgXCJkdW1teVwiLCBcImNvbmZpZGVuY2VfbWFuaXBcIiwgXCJhaV9leHBsYW5hdGlvblwiLCBcImFpX2NvbnRyYXN0aXZlX2V4cGxhbmF0aW9uXCJdXG5sZXQgQUlJbnRlcnZlbnRpb25UeXBlID0gdXJsUGFyYW1zLmdldChcImludGVydmVudGlvbl90eXBlXCIpXG5pZiAoQUlJbnRlcnZlbnRpb25UeXBlID09IG51bGwpIHtBSUludGVydmVudGlvblR5cGUgPSBcIm5vbmVcIn0gXG5pZiAoIXZhbGlkSW50ZXJ2ZW50aW9uVHlwZXMuaW5jbHVkZXMoQUlJbnRlcnZlbnRpb25UeXBlISkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEFJIEFzc2lzdGFuY2UgSW50ZXJ2ZW50aW9uOiBcIiArIEFJSW50ZXJ2ZW50aW9uVHlwZSlcbn1cblxuY29uc3QgdmFsaWRJbnRlcnZlbnRpb25TdHJhdGVnaWVzID0gW1wiZHVtbXlcIiwgXCJmaXhlZFwiLCBcImFkYXB0aXZlXCJdXG5sZXQgQUlJbnRlcnZlbnRpb25TdHJhdGVneSA9IHVybFBhcmFtcy5nZXQoXCJpbnRlcnZlbnRpb25fc3RyYXRlZ3lcIilcbmlmIChBSUludGVydmVudGlvblN0cmF0ZWd5ID09IG51bGwpIHtBSUludGVydmVudGlvblN0cmF0ZWd5ID0gXCJkdW1teVwifVxuaWYgKCF2YWxpZEludGVydmVudGlvblN0cmF0ZWdpZXMuaW5jbHVkZXMoQUlJbnRlcnZlbnRpb25TdHJhdGVneSEpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBBSSBBc3Npc3RhbmNlIEludGVydmVudGlvbiBTdHJhdGVneTogXCIgKyBBSUludGVydmVudGlvblN0cmF0ZWd5KVxufVxuXG4vLyBJbnRlcnZlbnRpb24tc3BlY2lmaWMgcGFyYW1ldGVyc1xubGV0IEludGVydmVudGlvbkFMRGlmZlRocmVzaG9sZCA9IE51bWJlcih1cmxQYXJhbXMuZ2V0KFwiaW50ZXJ2ZW50aW9uX3RocmVzaG9sZFwiKSlcbmlmIChJbnRlcnZlbnRpb25BTERpZmZUaHJlc2hvbGQgPT0gbnVsbCkge0ludGVydmVudGlvbkFMRGlmZlRocmVzaG9sZCA9IC0xfVxubGV0IEludGVydmVudGlvblRydXN0VGhyZXNob2xkID0gTnVtYmVyKHVybFBhcmFtcy5nZXQoXCJpbnRlcnZlbnRpb25fdHJ1c3RfdGhyZXNob2xkXCIpKVxuaWYgKEludGVydmVudGlvblRydXN0VGhyZXNob2xkID09IG51bGwpIHtJbnRlcnZlbnRpb25UcnVzdFRocmVzaG9sZCA9IDB9XG5sZXQgSW50ZXJ2ZW50aW9uRml4ZWRDb25mQ2hhbmdlID0gTnVtYmVyKHVybFBhcmFtcy5nZXQoXCJpbnRlcnZlbnRpb25fZml4ZWRjb25mY2hhbmdlXCIpKVxuaWYgKEludGVydmVudGlvbkZpeGVkQ29uZkNoYW5nZSA9PSBudWxsKSB7SW50ZXJ2ZW50aW9uRml4ZWRDb25mQ2hhbmdlID0gMH1cblxubGV0IHVzZVVzZXJSZXBvcnRlZFRydXN0VmFsID0gdXJsUGFyYW1zLmdldChcInVzZV91c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsXCIpID09IFwidHJ1ZVwiXG5pZiAodXNlVXNlclJlcG9ydGVkVHJ1c3RWYWwgPT0gbnVsbCkge3VzZVVzZXJSZXBvcnRlZFRydXN0VmFsID0gZmFsc2V9XG5cbmxldCBza2lwX3RydXN0X3JlcG9ydGluZyA9IHVybFBhcmFtcy5nZXQoXCJza2lwX3RydXN0X3JlcG9ydGluZ1wiKSA9PSBcInRydWVcIlxuaWYgKHNraXBfdHJ1c3RfcmVwb3J0aW5nID09IG51bGwpIHtza2lwX3RydXN0X3JlcG9ydGluZyA9IGZhbHNlfVxuXG5jb25zb2xlLmxvZyhcIkFJSW50ZXJ2ZW50aW9uR29hbDogXCIsIEFJSW50ZXJ2ZW50aW9uR29hbClcbmNvbnNvbGUubG9nKFwiQUlJbnRlcnZlbnRpb25UeXBlOiBcIiwgQUlJbnRlcnZlbnRpb25UeXBlKVxuY29uc29sZS5sb2coXCJBSUludGVydmVudGlvblN0cmF0ZWd5OiBcIiwgQUlJbnRlcnZlbnRpb25TdHJhdGVneSlcbmNvbnNvbGUubG9nKFwiSW50ZXJ2ZW50aW9uQUxEaWZmVGhyZXNob2xkOiBcIiwgSW50ZXJ2ZW50aW9uQUxEaWZmVGhyZXNob2xkKVxuY29uc29sZS5sb2coXCJJbnRlcnZlbnRpb25UcnVzdFRocmVzaG9sZDogXCIsIEludGVydmVudGlvblRydXN0VGhyZXNob2xkKVxuY29uc29sZS5sb2coXCJJbnRlcnZlbnRpb25GaXhlZENvbmZDaGFuZ2U6IFwiLCBJbnRlcnZlbnRpb25GaXhlZENvbmZDaGFuZ2UpXG5jb25zb2xlLmxvZyhcInVzZVVzZXJSZXBvcnRlZFRydXN0VmFsOiBcIiwgdXNlVXNlclJlcG9ydGVkVHJ1c3RWYWwpXG5jb25zb2xlLmxvZyhcInNraXBfdHJ1c3RfcmVwb3J0aW5nOiBcIiwgc2tpcF90cnVzdF9yZXBvcnRpbmcpXG5cbmlmIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJtaXRpZ2F0ZV91bmRlcnRydXN0XCIpIHtcbiAgICBhc3NlcnQoSW50ZXJ2ZW50aW9uVHJ1c3RUaHJlc2hvbGQgPD0gMCwgXCJUcnVzdCB0aHJlc2hvbGQgZm9yIG1pdGlnYXRpbmcgdW5kZXJ0cnVzdCBjYW5ub3QgYmUgcG9zaXRpdmUuXCIpXG4gICAgYXNzZXJ0KEludGVydmVudGlvbkZpeGVkQ29uZkNoYW5nZSA+PSAwLCBcIkNvbmZpZGVuY2UgY2hhbmdlIGZvciBtaXRpZ2F0aW5nIHVuZGVydHJ1c3QgY2Fubm90IGJlIG5lZ2F0aXZlLlwiKVxufSBlbHNlIGlmIChBSUludGVydmVudGlvbkdvYWwgPT0gXCJtaXRpZ2F0ZV9vdmVydHJ1c3RcIikge1xuICAgIGFzc2VydChJbnRlcnZlbnRpb25UcnVzdFRocmVzaG9sZCA+PSAwLCBcIlRydXN0IHRocmVzaG9sZCBmb3IgbWl0aWdhdGluZyBvdmVydHJ1c3QgY2Fubm90IGJlIG5lZ2F0aXZlLlwiKVxuICAgIGFzc2VydChJbnRlcnZlbnRpb25GaXhlZENvbmZDaGFuZ2UgPD0gMCwgXCJDb25maWRlbmNlIGNoYW5nZSBmb3IgbWl0aWdhdGluZyBvdmVydHJ1c3QgY2Fubm90IGJlIHBvc2l0aXZlLlwiKVxufVxuXG5nbG9iYWxUaGlzLnVybF9kYXRhW1wiaW50ZXJ2ZW50aW9uX2dvYWxcIl0gPSBBSUludGVydmVudGlvbkdvYWxcbmdsb2JhbFRoaXMudXJsX2RhdGFbXCJpbnRlcnZlbnRpb25fdHlwZVwiXSA9IEFJSW50ZXJ2ZW50aW9uVHlwZVxuZ2xvYmFsVGhpcy51cmxfZGF0YVtcImludGVydmVudGlvbl9zdHJhdGVneVwiXSA9IEFJSW50ZXJ2ZW50aW9uU3RyYXRlZ3lcbmdsb2JhbFRoaXMudXJsX2RhdGFbXCJpbnRlcnZlbnRpb25fdGhyZXNob2xkXCJdID0gSW50ZXJ2ZW50aW9uQUxEaWZmVGhyZXNob2xkXG5nbG9iYWxUaGlzLnVybF9kYXRhW1wiaW50ZXJ2ZW50aW9uX2ZpeGVkY29uZmNoYW5nZVwiXSA9IEludGVydmVudGlvbkZpeGVkQ29uZkNoYW5nZVxuZ2xvYmFsVGhpcy51cmxfZGF0YVtcInVzZV91c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsXCJdID0gdXNlVXNlclJlcG9ydGVkVHJ1c3RWYWxcblxuLy8gdmVyc2lvbiBmb3IgcGFwZXJcbmlmIChnbG9iYWxUaGlzLnVpZC5zdGFydHNXaXRoKFwiZGVtb19wYXBlclwiKSkge1xuICAgIE1PQ0tNT0RFID0gdHJ1ZVxufSBlbHNlIHtcblxufVxuY29uc29sZS5sb2coXCJSdW5uaW5nIHdpdGggVUlEXCIsIGdsb2JhbFRoaXMudWlkKVxubG9hZF9kYXRhKCkuY2F0Y2goKF9lcnJvcikgPT4ge1xuICAgIC8vYWxlcnQoXCJJbnZhbGlkIHVzZXIgaWQuXCIpXG4gICAgY29uc29sZS5sb2coXCJJbnZhbGlkIHVzZXIgaWQuXCIpXG4gICAgY29uc29sZS5sb2coZ2xvYmFsVGhpcy51aWQhKVxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxufVxuKS50aGVuKChuZXdfZGF0YSkgPT4ge1xuICAgIGRhdGEgPSBuZXdfZGF0YVxuICAgIGlmIChzdGFydE92ZXJyaWRlICE9IG51bGwpIHtcbiAgICAgICAgcXVlc3Rpb25faSA9IHBhcnNlSW50KHN0YXJ0T3ZlcnJpZGUpIC0gMVxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJ0aW5nIGZyb21cIiwgcXVlc3Rpb25faSlcbiAgICB9XG4gICAgLy8gbmV4dF9xdWVzdGlvbigpXG4gICAgbmV4dF9pbnN0cnVjdGlvbnMoMClcbiAgICAkKFwiI21haW5fYm94X2luc3RydWN0aW9uc1wiKS5zaG93KClcbiAgICAkKFwiI2luc3RydWN0aW9uc19hbmRfZGVjb3JhdGlvbnNcIikuaGlkZSgpXG59KVxuXG5jb25zb2xlLmxvZyhcIlN0YXJ0aW5nIHNlc3Npb24gd2l0aCBVSUQ6XCIsIGdsb2JhbFRoaXMudWlkISlcblxubGV0IGFsZXJ0X2FjdGl2ZSA9IGZhbHNlXG5kb2N1bWVudC5vbnZpc2liaWxpdHljaGFuZ2UgPSAoKSA9PiB7XG4gICAgaWYgKCFhbGVydF9hY3RpdmUpIHtcbiAgICAgICAgY291bnRfZXhpdGVkX3BhZ2UgKz0gMVxuICAgICAgICBhbGVydF9hY3RpdmUgPSB0cnVlXG4gICAgICAgIGlmICghKGdsb2JhbFRoaXMudWlkIS5zdGFydHNXaXRoKFwiZGVtb1wiKSkgJiYgIShERVZNT0RFKSkge1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgZG9uJ3QgbGVhdmUgdGhlIHBhZ2UuIElmIHlvdSBkbyBzbyBhZ2Fpbiwgd2UgbWF5IHJlc3RyaWN0IHBheWluZyB5b3UuXCIpXG4gICAgICAgIH1cbiAgICAgICAgYWxlcnRfYWN0aXZlID0gZmFsc2VcbiAgICB9XG59Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiU0VSVkVSX0xPR19ST09UIiwiYWN0aXZlVGltZXIiLCJzdGFydFRpbWVyIiwiZHVyYXRpb24iLCJzdGVwRGl2IiwiYnV0dG9ucyIsImNhbGxiYWNrIiwibWVzc2FnZSIsImNsZWFySW50ZXJ2YWwiLCJmb3JFYWNoIiwiYnV0dG9uIiwic2V0QXR0cmlidXRlIiwidGltZXJEaXNwbGF5IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJzdHlsZSIsImZvbnRXZWlnaHQiLCJtYXJnaW5Ub3AiLCJhcHBlbmRDaGlsZCIsInJlbWFpbmluZ1RpbWUiLCJ0ZXh0Q29udGVudCIsInNldEludGVydmFsIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJNT0NLTU9ERSIsImRhdGEiLCJ0aW1lX3F1ZXN0aW9uX3N0YXJ0IiwidGltZV9maW5hbF9kZWNpc2lvbl9zdGFydCIsInRpbWVfdHJ1c3RfZGVjaXNpb25fc3RhcnQiLCJ0aW1lX2luaXRpYWxfY29uZmlkZW5jZV9zdGFydCIsInRpbWVfZmluYWxfY29uZmlkZW5jZV9zdGFydCIsInF1ZXN0aW9uX2kiLCJxdWVzdGlvbiIsImluaXRpYWxfdXNlcl9kZWNpc2lvbiIsImZpbmFsX3VzZXJfZGVjaXNpb24iLCJpbml0aWFsX3VzZXJfY29uZmlkZW5jZSIsImZpbmFsX3VzZXJfY29uZmlkZW5jZSIsImJhbGFuY2UiLCJ1c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsIiwicHJldl91c2VyX3JlcG9ydGVkX3RydXN0X2xldmVsIiwiYmV0X3ZhbF9yYXRpbyIsImluc3RydWN0aW9uX2kiLCJjb3VudF9leGl0ZWRfcGFnZSIsImludGVydmVudGlvbl9kZXRhaWxzIiwidHJ1c3RfZWZmZWN0X3ByZWRpY3Rpb25fZGF0YSIsImFzc2VydCIsImNvbmRpdGlvbiIsIm5leHRfaW5zdHJ1Y3Rpb25zIiwiaW5jcmVtZW50Iiwic2tpcF90cnVzdF9yZXBvcnRpbmciLCIkIiwiYXR0ciIsInJlbW92ZUF0dHIiLCJzaG93IiwidmFsIiwiaGlkZSIsIm5leHRfcXVlc3Rpb24iLCJjaGlsZHJlbiIsImVhY2giLCJfIiwiZWwiLCJtYWtlX2luaXRpYWxfdXNlcl9kZWNpc2lvbiIsIm9wdGlvbiIsIkRhdGUiLCJub3ciLCJnZXRfaW5pdGlhbF91c2VyX2NvbmZpZGVuY2UiLCJjb25mX2xldmVsIiwiYXN5bmMiLCJjb25zb2xlIiwibG9nIiwiZGlzcGxheWVkX2FpX2NvbmZpZGVuY2UiLCJ1c2VyX2N1cnJlbnRfdHJ1c3RfbGV2ZWwiLCJ1c2VVc2VyUmVwb3J0ZWRUcnVzdFZhbCIsIkFJSW50ZXJ2ZW50aW9uVHlwZSIsIkFJSW50ZXJ2ZW50aW9uR29hbCIsIkludGVydmVudGlvblRydXN0VGhyZXNob2xkIiwiQUlJbnRlcnZlbnRpb25TdHJhdGVneSIsImFpX2NvbmZpZGVuY2UiLCJOdW1iZXIiLCJyZXBsYWNlIiwibmV3X2NvbmZpZGVuY2UiLCJNYXRoIiwibWluIiwiSW50ZXJ2ZW50aW9uRml4ZWRDb25mQ2hhbmdlIiwibWF4IiwiU3RyaW5nIiwidG9GaXhlZCIsImNvbmZpZGVuY2VfY2hhbmdlIiwiZXhwbGFuYXRpb25fc2hvd24iLCJodG1sIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRfYWlfYXNzaXN0YW5jZSIsIm1ha2VfZmluYWxfdXNlcl9kZWNpc2lvbiIsImdldF9maW5hbF91c2VyX2NvbmZpZGVuY2UiLCJjb3JyZWN0X29wdGlvbiIsInVzZXJfaXNfY29ycmVjdCIsImFpX2lzX2NvcnJlY3QiLCJ0ZXh0Iiwic2hvd19yZXN1bHQiLCJsZW5ndGgiLCJyYXRpbzEiLCJyYXRpbzIiLCJvbiIsImxvZ2dlZF9kYXRhIiwiZ2xvYmFsVGhpcyIsInVybF9kYXRhIiwidWlkIiwiYWpheCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9qZWN0IiwicGF5bG9hZCIsInR5cGUiLCJjb250ZW50VHlwZSIsImUiLCJsb2dfZGF0YSIsInRoaXMiLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN0YXJ0T3ZlcnJpZGUiLCJVSURGcm9tVVJMIiwiZW50cmllcyIsInJlc3VsdCIsInZhbHVlIiwicGFyYW1zVG9PYmplY3QiLCJxdWV1ZV9pZCIsImZsb29yIiwicmFuZG9tIiwicGFkU3RhcnQiLCJVSURfbWF5YmUiLCJwcm9tcHQiLCJpbnRlcnZlbnRpb25fYWxsb3dlZF90aW1lc3RlcHMiLCJpbmNsdWRlcyIsIkVycm9yIiwiSW50ZXJ2ZW50aW9uQUxEaWZmVGhyZXNob2xkIiwic3RhcnRzV2l0aCIsImdldEpTT04iLCJsb2FkX2RhdGEiLCJjYXRjaCIsIl9lcnJvciIsInJlbG9hZCIsInRoZW4iLCJuZXdfZGF0YSIsInBhcnNlSW50IiwiYWxlcnRfYWN0aXZlIiwib252aXNpYmlsaXR5Y2hhbmdlIiwiYWxlcnQiXSwic291cmNlUm9vdCI6IiJ9